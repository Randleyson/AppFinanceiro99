{$A8,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N-,O+,P+,Q-,R-,S-,T-,U-,V+,W-,X+,Y+,Z1}
{$MINSTACKSIZE $00004000}
{$MAXSTACKSIZE $00100000}
{$IMAGEBASE $00400000}
{$APPTYPE GUI}
{$WARN SYMBOL_DEPRECATED ON}
{$WARN SYMBOL_LIBRARY ON}
{$WARN SYMBOL_PLATFORM ON}
{$WARN SYMBOL_EXPERIMENTAL ON}
{$WARN UNIT_LIBRARY ON}
{$WARN UNIT_PLATFORM ON}
{$WARN UNIT_DEPRECATED ON}
{$WARN UNIT_EXPERIMENTAL ON}
{$WARN HRESULT_COMPAT ON}
{$WARN HIDING_MEMBER ON}
{$WARN HIDDEN_VIRTUAL ON}
{$WARN GARBAGE ON}
{$WARN BOUNDS_ERROR ON}
{$WARN ZERO_NIL_COMPAT ON}
{$WARN STRING_CONST_TRUNCED ON}
{$WARN FOR_LOOP_VAR_VARPAR ON}
{$WARN TYPED_CONST_VARPAR ON}
{$WARN ASG_TO_TYPED_CONST ON}
{$WARN CASE_LABEL_RANGE ON}
{$WARN FOR_VARIABLE ON}
{$WARN CONSTRUCTING_ABSTRACT ON}
{$WARN COMPARISON_FALSE ON}
{$WARN COMPARISON_TRUE ON}
{$WARN COMPARING_SIGNED_UNSIGNED ON}
{$WARN COMBINING_SIGNED_UNSIGNED ON}
{$WARN UNSUPPORTED_CONSTRUCT ON}
{$WARN FILE_OPEN ON}
{$WARN FILE_OPEN_UNITSRC ON}
{$WARN BAD_GLOBAL_SYMBOL ON}
{$WARN DUPLICATE_CTOR_DTOR ON}
{$WARN INVALID_DIRECTIVE ON}
{$WARN PACKAGE_NO_LINK ON}
{$WARN PACKAGED_THREADVAR ON}
{$WARN IMPLICIT_IMPORT ON}
{$WARN HPPEMIT_IGNORED ON}
{$WARN NO_RETVAL ON}
{$WARN USE_BEFORE_DEF ON}
{$WARN FOR_LOOP_VAR_UNDEF ON}
{$WARN UNIT_NAME_MISMATCH ON}
{$WARN NO_CFG_FILE_FOUND ON}
{$WARN IMPLICIT_VARIANTS ON}
{$WARN UNICODE_TO_LOCALE ON}
{$WARN LOCALE_TO_UNICODE ON}
{$WARN IMAGEBASE_MULTIPLE ON}
{$WARN SUSPICIOUS_TYPECAST ON}
{$WARN PRIVATE_PROPACCESSOR ON}
{$WARN UNSAFE_TYPE OFF}
{$WARN UNSAFE_CODE OFF}
{$WARN UNSAFE_CAST OFF}
{$WARN OPTION_TRUNCATED ON}
{$WARN WIDECHAR_REDUCED ON}
{$WARN DUPLICATES_IGNORED ON}
{$WARN UNIT_INIT_SEQ ON}
{$WARN LOCAL_PINVOKE ON}
{$WARN MESSAGE_DIRECTIVE ON}
{$WARN TYPEINFO_IMPLICITLY_ADDED ON}
{$WARN RLINK_WARNING ON}
{$WARN IMPLICIT_STRING_CAST ON}
{$WARN IMPLICIT_STRING_CAST_LOSS ON}
{$WARN EXPLICIT_STRING_CAST OFF}
{$WARN EXPLICIT_STRING_CAST_LOSS OFF}
{$WARN CVT_WCHAR_TO_ACHAR ON}
{$WARN CVT_NARROWING_STRING_LOST ON}
{$WARN CVT_ACHAR_TO_WCHAR ON}
{$WARN CVT_WIDENING_STRING_LOST ON}
{$WARN NON_PORTABLE_TYPECAST ON}
{$WARN XML_WHITESPACE_NOT_ALLOWED ON}
{$WARN XML_UNKNOWN_ENTITY ON}
{$WARN XML_INVALID_NAME_START ON}
{$WARN XML_INVALID_NAME ON}
{$WARN XML_EXPECTED_CHARACTER ON}
{$WARN XML_CREF_NO_RESOLVE ON}
{$WARN XML_NO_PARM ON}
{$WARN XML_NO_MATCHING_PARM ON}
{$WARN IMMUTABLE_STRINGS OFF}
{$A8,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N-,O+,P+,Q-,R-,S-,T-,U-,V+,W-,X+,Y+,Z1}
{$MINSTACKSIZE $00004000}
{$MAXSTACKSIZE $00100000}
{$IMAGEBASE $00400000}
{$APPTYPE GUI}
{$WARN SYMBOL_DEPRECATED ON}
{$WARN SYMBOL_LIBRARY ON}
{$WARN SYMBOL_PLATFORM ON}
{$WARN SYMBOL_EXPERIMENTAL ON}
{$WARN UNIT_LIBRARY ON}
{$WARN UNIT_PLATFORM ON}
{$WARN UNIT_DEPRECATED ON}
{$WARN UNIT_EXPERIMENTAL ON}
{$WARN HRESULT_COMPAT ON}
{$WARN HIDING_MEMBER ON}
{$WARN HIDDEN_VIRTUAL ON}
{$WARN GARBAGE ON}
{$WARN BOUNDS_ERROR ON}
{$WARN ZERO_NIL_COMPAT ON}
{$WARN STRING_CONST_TRUNCED ON}
{$WARN FOR_LOOP_VAR_VARPAR ON}
{$WARN TYPED_CONST_VARPAR ON}
{$WARN ASG_TO_TYPED_CONST ON}
{$WARN CASE_LABEL_RANGE ON}
{$WARN FOR_VARIABLE ON}
{$WARN CONSTRUCTING_ABSTRACT ON}
{$WARN COMPARISON_FALSE ON}
{$WARN COMPARISON_TRUE ON}
{$WARN COMPARING_SIGNED_UNSIGNED ON}
{$WARN COMBINING_SIGNED_UNSIGNED ON}
{$WARN UNSUPPORTED_CONSTRUCT ON}
{$WARN FILE_OPEN ON}
{$WARN FILE_OPEN_UNITSRC ON}
{$WARN BAD_GLOBAL_SYMBOL ON}
{$WARN DUPLICATE_CTOR_DTOR ON}
{$WARN INVALID_DIRECTIVE ON}
{$WARN PACKAGE_NO_LINK ON}
{$WARN PACKAGED_THREADVAR ON}
{$WARN IMPLICIT_IMPORT ON}
{$WARN HPPEMIT_IGNORED ON}
{$WARN NO_RETVAL ON}
{$WARN USE_BEFORE_DEF ON}
{$WARN FOR_LOOP_VAR_UNDEF ON}
{$WARN UNIT_NAME_MISMATCH ON}
{$WARN NO_CFG_FILE_FOUND ON}
{$WARN IMPLICIT_VARIANTS ON}
{$WARN UNICODE_TO_LOCALE ON}
{$WARN LOCALE_TO_UNICODE ON}
{$WARN IMAGEBASE_MULTIPLE ON}
{$WARN SUSPICIOUS_TYPECAST ON}
{$WARN PRIVATE_PROPACCESSOR ON}
{$WARN UNSAFE_TYPE OFF}
{$WARN UNSAFE_CODE OFF}
{$WARN UNSAFE_CAST OFF}
{$WARN OPTION_TRUNCATED ON}
{$WARN WIDECHAR_REDUCED ON}
{$WARN DUPLICATES_IGNORED ON}
{$WARN UNIT_INIT_SEQ ON}
{$WARN LOCAL_PINVOKE ON}
{$WARN MESSAGE_DIRECTIVE ON}
{$WARN TYPEINFO_IMPLICITLY_ADDED ON}
{$WARN RLINK_WARNING ON}
{$WARN IMPLICIT_STRING_CAST ON}
{$WARN IMPLICIT_STRING_CAST_LOSS ON}
{$WARN EXPLICIT_STRING_CAST OFF}
{$WARN EXPLICIT_STRING_CAST_LOSS OFF}
{$WARN CVT_WCHAR_TO_ACHAR ON}
{$WARN CVT_NARROWING_STRING_LOST ON}
{$WARN CVT_ACHAR_TO_WCHAR ON}
{$WARN CVT_WIDENING_STRING_LOST ON}
{$WARN NON_PORTABLE_TYPECAST ON}
{$WARN XML_WHITESPACE_NOT_ALLOWED ON}
{$WARN XML_UNKNOWN_ENTITY ON}
{$WARN XML_INVALID_NAME_START ON}
{$WARN XML_INVALID_NAME ON}
{$WARN XML_EXPECTED_CHARACTER ON}
{$WARN XML_CREF_NO_RESOLVE ON}
{$WARN XML_NO_PARM ON}
{$WARN XML_NO_MATCHING_PARM ON}
{$WARN IMMUTABLE_STRINGS OFF}
unit uFrmPrincipal;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes,
  System.Variants,
  FMX.Types, FMX.Controls, FMX.Forms, FMX.Graphics, FMX.Dialogs, FMX.Objects,
  FMX.TabControl, FMX.StdCtrls, FMX.Edit, FMX.Controls.Presentation,
  FMX.Layouts,
  System.Actions, FMX.ActnList, FMX.ListBox, FMX.MultiView, FMX.ListView.Types,
  FMX.ListView.Appearances, FMX.ListView.Adapters.Base, FMX.ListView, db,
  {MultiDetailAppearanceU} System.ImageList, FMX.ImgList, DateUtils,
  FMX.DateTimeCtrls, System.UIConsts, FMX.VirtualKeyboard, FMX.Platform,
  {FGX.ActionSheet,} System.IOUtils, System.StrUtils, FMX.ComboEdit,
  FMX.ComboTrackBar, FMX.Ani, FMX.Effects, FMX.Filter.Effects,uDatamodule,
  System.Rtti, FMX.Grid.Style, FMX.Grid, FMX.ScrollBox



{$IFDEF ANDROID}
    , FMX.Helpers.Android, FMX.Platform.Android
{$ENDIF}
    ;

type
  TfrmPrincipal = class(TForm)
    tabC_Princ: TTabControl;
    tabPrinc_Login: TTabItem;
    tabPrinc_Home: TTabItem;
    RectLogin: TRectangle;
    ImgLoginLogo: TImage;
    Layout1: TLayout;
    EdtLoginSenha: TEdit;
    StyleBook1: TStyleBook;
    MultiView: TMultiView;
    Rectangle3: TRectangle;
    Image2: TImage;
    ListBox1: TListBox;
    listBoxPaine: TListBoxItem;
    ListBoxItem_Lancamento: TListBoxItem;
    ListBoxItem_Categoria: TListBoxItem;
    ListBoxItem_Perfil: TListBoxItem;
    tabPrinc_Lancamento: TTabItem;
    tabPrinc_Categoria: TTabItem;
    tabPrinc_CadCategoria: TTabItem;
    BtnCadCategoriaSalva: TSpeedButton;
    Label15: TLabel;
    EdtCadCategoriaDesc: TEdit;
    lstCategoria: TListView;
    BtnCadCategoriaExclui: TSpeedButton;
    TabPrinc_Perfil: TTabItem;
    lstPerfil: TListBox;
    lstiItemIdiomaEmoeda: TListBoxItem;
    lstItemSenha: TListBoxItem;
    tabPrinc_Idiona: TTabItem;
    ToolBar6: TToolBar;
    Label18: TLabel;
    BtnConfigVolta: TSpeedButton;
    BtnConfigSalva: TSpeedButton;
    ListBox3: TListBox;
    ListBoxItem2: TListBoxItem;
    ListBoxItem4: TListBoxItem;
    ListBox4: TListBox;
    ListBoxItem5: TListBoxItem;
    ListBoxItem6: TListBoxItem;
    lblLoginCriaNovaConta: TLabel;
    Layout9: TLayout;
    EdtCadLoginNone: TEdit;
    edtCadLoginSenha: TEdit;
    edtCadLoginConfiSenha: TEdit;
    Label23: TLabel;
    SpeedButton2: TSpeedButton;
    rectBtnAcessar: TRectangle;
    ToolBarInformativa: TToolBar;
    LblTbrInformacao: TLabel;
    TimFechaInformacao: TTimer;
    rectBtnCadUsuario: TRectangle;
    Layout10: TLayout;
    Rectangle1: TRectangle;
    ImgLstLogo: TImageList;
    Label1: TLabel;
    lblSaldoAtual: TLabel;
    RectPerfilLogoff: TRectangle;
    Rectangle8: TRectangle;
    TabPrinc_CadLancamento: TTabItem;
    rectToolBarCadLancamento: TRectangle;
    btnCadLancVoltar: TSpeedButton;
    lblTituloCadLancamento: TLabel;
    actTab_Principal: TActionList;
    actPrinc_CadLancamento: TChangeTabAction;
    actPrinc_Home: TChangeTabAction;
    actPrinc_Login: TChangeTabAction;
    actTab_CadLanc: TActionList;
    actCadLanc_Primaria: TChangeTabAction;
    actCadLanc_Secundaria: TChangeTabAction;
    actPrinc_CadCategoria: TChangeTabAction;
    actPrinc_Categoria: TChangeTabAction;
    imglstIcoBtn: TImageList;
    actPrinc_Lancamento: TChangeTabAction;
    actPrinc_Perfil: TChangeTabAction;
    tabPrinc_Teste: TTabItem;
    btnAcessar: TSpeedButton;
    TabcLogin: TTabControl;
    tabLogin_Logar: TTabItem;
    tabLogin_CadUsuario: TTabItem;
    btnCadastarUsuario: TSpeedButton;
    BtnPerfilLogoff: TSpeedButton;
    actTab_Login: TActionList;
    actLogin_Logar: TChangeTabAction;
    actLogin_CadUsuario: TChangeTabAction;
    Image1: TImage;
    lblUsuarioLogin: TLabel;
    Rectangle29: TRectangle;
    rectHomeTop: TRectangle;
    Layout31: TLayout;
    Image5: TImage;
    Layout32: TLayout;
    Layout33: TLayout;
    Rectangle30: TRectangle;
    Layout34: TLayout;
    lblDataAtualtabiHome: TLabel;
    Layout36: TLayout;
    lblSaldoAtualLinhaTempo: TLabel;
    lblSaldoRestanteLinhaTempo: TLabel;
    lblApagarLinhaTempo: TLabel;
    lblAreceberLinhaTempo: TLabel;
    Rectangle31: TRectangle;
    Rectangle32: TRectangle;
    ShadowEffect2: TShadowEffect;
    ShadowEffect3: TShadowEffect;
    lytUltimoLancamento: TLayout;
    Layout37: TLayout;
    Label37: TLabel;
    SpeedButton11: TSpeedButton;
    Label38: TLabel;
    Layout35: TLayout;
    Image3: TImage;
    Image6: TImage;
    Image7: TImage;
    Image8: TImage;
    Line1: TLine;
    Line4: TLine;
    Line5: TLine;
    BlurEffect1: TBlurEffect;
    lstUltimoLanc: TListView;
    imgUltimoLancDespesa: TImage;
    imgUltimoLancReceita: TImage;
    layoutMenu: TLayout;
    Image10: TImage;
    Image11: TImage;
    Image12: TImage;
    imgBtnNovoLancamento: TImage;
    Rectangle2: TRectangle;
    Rectangle4: TRectangle;
    Rectangle12: TRectangle;
    Rectangle13: TRectangle;
    actCadLanc_Novo: TChangeTabAction;
    lstItemDimensao: TListBoxItem;
    rectToolBarHome: TRectangle;
    btnHomeMenu: TSpeedButton;
    Layout14: TLayout;
    Label2: TLabel;
    lblHomeNomeUsuario: TLabel;
    BlurEffect2: TBlurEffect;
    tabcCadLanc: TTabControl;
    tabCadLanc_Novo: TTabItem;
    Layout11: TLayout;
    Layout12: TLayout;
    rectNovaReceita: TRectangle;
    Image14: TImage;
    Label3: TLabel;
    rectNovaDespesa: TRectangle;
    Image13: TImage;
    Label4: TLabel;
    tabCadLanc_Primaria: TTabItem;
    tabCadLanc_Secundaria: TTabItem;
    tabCadLanc_categoria: TTabItem;
    RoundRect1: TRoundRect;
    Rectangle9: TRectangle;
    rectCabecalho: TRectangle;
    lblCabecalhoCadLanc: TLabel;
    edtCadLancDescricao: TEdit;
    Layout16: TLayout;
    edtCadLancValor: TEdit;
    edtCadLancData: TDateEdit;
    edtCadLancCategoria: TEdit;
    Layout19: TLayout;
    lblCadLancPago: TLabel;
    Label7: TLabel;
    Layout20: TLayout;
    Layout21: TLayout;
    Layout25: TLayout;
    Layout26: TLayout;
    swiCadLancPago: TSwitch;
    SwiCadLancRepeti: TSwitch;
    edtCadLancNroParcela: TEdit;
    Layout27: TLayout;
    lstCategoriaCadLanc: TListBox;
    Layout30: TLayout;
    SpeedButton5: TSpeedButton;
    SpeedButton6: TSpeedButton;
    Layout38: TLayout;
    ShadowEffect4: TShadowEffect;
    rectCadLanc_Ontem: TRectangle;
    SpeedButton7: TSpeedButton;
    rectCadLanc_Amanha: TRectangle;
    SpeedButton8: TSpeedButton;
    rectCadLanc_Hoje: TRectangle;
    SpeedButton9: TSpeedButton;
    rectCadLanc_person: TRectangle;
    SpeedButton10: TSpeedButton;
    Layout39: TLayout;
    Layout17: TLayout;
    Rectangle20: TRectangle;
    btnAvancarTabSecundaria: TSpeedButton;
    Layout40: TLayout;
    Layout24: TLayout;
    Rectangle23: TRectangle;
    btnCadLancGravarLanc: TSpeedButton;
    Layout15: TLayout;
    Rectangle19: TRectangle;
    btnSalvarCategoria_CadLanc: TSpeedButton;
    actCadLanc_Categoria: TChangeTabAction;
    btnToolBarNovoCategoria: TSpeedButton;
    Label5: TLabel;
    Rectangle14: TRectangle;
    Label8: TLabel;
    btnCadCategoriaVoltar: TSpeedButton;
    Rectangle6: TRectangle;
    Layout22: TLayout;
    Label9: TLabel;
    btnCategoriaVoltar: TSpeedButton;
    btnCategoriaNova: TSpeedButton;
    rectToolbarPerfil: TRectangle;
    SpeedButton1: TSpeedButton;
    Label6: TLabel;
    Layout13: TLayout;
    Circle1: TCircle;
    lstItemUsuario: TListBoxItem;
    edtPerfilUsuario: TEdit;
    edtPerfilSenha: TEdit;
    edtPerfilDimessao: TEdit;
    btnPerfilCancSenha: TSpeedButton;
    edtPerfilIdiomaMoeda: TEdit;
    btnPerfilRefleshDimessao: TSpeedButton;
    Layout18: TLayout;
    Image4: TImage;
    BlurEffect3: TBlurEffect;
    Label11: TLabel;
    Label13: TLabel;
    Label14: TLabel;
    Label16: TLabel;
    Label17: TLabel;
    btnPerfilCancUsuario: TSpeedButton;
    btnPerfilEditUsuario: TSpeedButton;
    btnPerfilEditSenha: TSpeedButton;
    SpeedButton13: TSpeedButton;
    Layout28: TLayout;
    TabC_Lancamento: TTabControl;
    tabLanc_Lancamento: TTabItem;
    tabLanc_Resuno: TTabItem;
    rectLanc_ToolBar: TRectangle;
    Label10: TLabel;
    SpeedButton3: TSpeedButton;
    lytLanc_Filtro: TLayout;
    Layout7: TLayout;
    Layout8: TLayout;
    Label12: TLabel;
    Label19: TLabel;
    chbLanc_apagar: TCheckBox;
    chbLanc_pago: TCheckBox;
    chbLanc_Areceber: TCheckBox;
    chbLanc_Recebido: TCheckBox;
    btnLanc_FiltroData: TSpeedButton;
    layoutLanc_FiltroData: TLayout;
    SpeedButton12: TSpeedButton;
    SpeedButton14: TSpeedButton;
    lblMesAno_Lanc: TLabel;
    Rectangle5: TRectangle;
    ShadowEffect1: TShadowEffect;
    Label32: TLabel;
    Layout6: TLayout;
    Layout41: TLayout;
    Layout42: TLayout;
    Label33: TLabel;
    Label34: TLabel;
    Label35: TLabel;
    Label36: TLabel;
    Label39: TLabel;
    Label40: TLabel;
    Label41: TLabel;
    Label42: TLabel;
    Label43: TLabel;
    Label44: TLabel;
    Label45: TLabel;
    Label46: TLabel;
    actTab_Lanc: TActionList;
    actTabLanc_Lancamento: TChangeTabAction;
    actTabLanc_Resumo: TChangeTabAction;
    actTabLanc_Despesa: TChangeTabAction;
    actTabLanc_Receita: TChangeTabAction;
    Button1: TButton;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    MultiViewLanc_FiltroData: TMultiView;
    btnLanc_AtivarFiltro: TSpeedButton;
    Layout43: TLayout;
    Rectangle7: TRectangle;
    lstLancamento_Lanc: TListView;
    Layout23: TLayout;
    lblLanc_TotalizadorPrevReceita: TLabel;
    Label27: TLabel;
    Layout44: TLayout;
    Layout45: TLayout;
    Label21: TLabel;
    lblLanc_TotalizadorPrevDespesa: TLabel;
    Layout46: TLayout;
    Label24: TLabel;
    lblLanc_TotalizadorPrevSaldo: TLabel;
    Layout29: TLayout;
    Layout47: TLayout;
    Label28: TLabel;
    lblLanc_TotalizadorReceita: TLabel;
    Layout48: TLayout;
    Label30: TLabel;
    lblLanc_TotalizadorDespesa: TLabel;
    Layout49: TLayout;
    Label47: TLabel;
    lblLanc_TotalizadorSaldo: TLabel;
    Rectangle10: TRectangle;
    ShadowEffect5: TShadowEffect;
    Rectangle11: TRectangle;
    Rectangle15: TRectangle;
    Rectangle16: TRectangle;
    Rectangle17: TRectangle;
    Layout50: TLayout;
    ShadowEffect6: TShadowEffect;
    procedure ListBoxItem_CategoriaClick(Sender: TObject);
    procedure lstCategoriaItemClickEx(const Sender: TObject;
      ItemIndex: Integer; const LocalClickPos: TPointF;
      const ItemObject: TListItemDrawable);
    procedure ListBoxItem_PerfilClick(Sender: TObject);
    procedure BtnLancamentoVoltaMesClick(Sender: TObject);
    procedure BtnLancamentoAvancaMesClick(Sender: TObject);
    procedure TimFechaInformacaoTimer(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure FormKeyUp(Sender: TObject; var Key: Word; var KeyChar: Char;
      Shift: TShiftState);
    procedure EdtCadLancaValorKeyDown(Sender: TObject; var Key: Word;
      var KeyChar: Char; Shift: TShiftState);
    procedure EdtCadCategoriaDescExit(Sender: TObject);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean);
    procedure FormCreate(Sender: TObject);
    procedure BtnHomeVoltaMesClick(Sender: TObject);
    procedure BtnHomeAvancaMesClick(Sender: TObject);
    procedure btnCadLancVoltarClick(Sender: TObject);
    procedure btnCadLanc_OntemClick(Sender: TObject);
    procedure edtCadLancValorKeyDown(Sender: TObject; var Key: Word;
      var KeyChar: Char; Shift: TShiftState);
    procedure btnAcessarClick(Sender: TObject);
    procedure btnCadastarUsuarioClick(Sender: TObject);
    procedure BtnPerfilLogoffClick(Sender: TObject);
    procedure SpeedButton2Click(Sender: TObject);
    procedure imgBtnNovoLancamentoClick(Sender: TObject);
    procedure rectNovaReceitaClick(Sender: TObject);
    procedure rectNovaDespesaClick(Sender: TObject);
    procedure btnAvancarTabSecundariaClick(Sender: TObject);
    procedure btnCadLancVoltaDataClick(Sender: TObject);
    procedure btnCadLancAvancaDataClick(Sender: TObject);
    procedure btnCadLanc_HojeClick(Sender: TObject);
    procedure btnCadLanc_AmanhaClick(Sender: TObject);
    procedure btnCadLanc_PersonClick(Sender: TObject);
    procedure edtCadLancDataChange(Sender: TObject);
    procedure edtCadLancCategoriaClick(Sender: TObject);
    procedure btnSalvarCategoria_CadLancClick(Sender: TObject);
    procedure btnToolBarNovoCategoriaClick(Sender: TObject);
    procedure btnCadLancGravarLancClick(Sender: TObject);
    procedure edtCadLancDataExit(Sender: TObject);
    procedure edtCadLancValorExit(Sender: TObject);
    procedure edtCadLancDescricaoExit(Sender: TObject);
    procedure btnCadCategoriaVoltarClick(Sender: TObject);
    procedure BtnCadCategoriaSalvaClick(Sender: TObject);
    procedure btnCategoriaNovaClick(Sender: TObject);
    procedure BtnCadCategoriaExcluiClick(Sender: TObject);
    procedure btnCategoriaVoltarClick(Sender: TObject);
    procedure swiCadLancPagoSwitch(Sender: TObject);
    procedure lblLoginCriaNovaContaClick(Sender: TObject);
    procedure btnPerfilRefleshDimessaoClick(Sender: TObject);
    procedure btnPerfilEditUsuarioClick(Sender: TObject);
    procedure lstPerfilItemClick(const Sender: TCustomListBox;
      const Item: TListBoxItem);
    procedure SpeedButton1Click(Sender: TObject);
    procedure btnPerfilCancUsuarioClick(Sender: TObject);
    procedure btnPerfilEditSenhaClick(Sender: TObject);
    procedure btnPerfilCancSenhaClick(Sender: TObject);
    procedure ListBoxItem_LancamentoClick(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure ListBoxItem1Click(Sender: TObject);
    procedure btnLanc_AtivarFiltroClick(Sender: TObject);
    procedure SpeedButton12Click(Sender: TObject);
    procedure SpeedButton14Click(Sender: TObject);
    procedure Image12Click(Sender: TObject);

  private
    { Private declarations }

    vMes, vAno:           Integer;
    vBkpUsuarioPerfil:    string;
    vBkpSenhaPerfil:      string;

  public
    { Public declarations }

    procedure MsgInformativaToolb (AMessagem: string);
    function FormateReal(AValorEntrada: string): string;
    function Convert(aValor1,aValor2,ResultTrue,ResultFalse: string): string;
    function DataSqlLite(Adata: TDateTime): string;
    function NomeMes(MesNunber: integer): string;


end;
  var
    frmPrincipal : TfrmPrincipal;
    Dm : TDm;

implementation

{$R *.fmx}
uses
  uLogin,uControleDeTela,_uDmProcedures,uCadLancamento,uCategoria,uPerfil,uLancamentos;

procedure TfrmPrincipal.FormShow(Sender: TObject);
begin
  Dm := TDm.Create(self);

  if Dm.ExistUsuarioLogado then
    uControleDeTela.AvancaTela(tabPrinc_Home)
  else
    uControleDeTela.AvancaTela(tabPrinc_Login);
end;

procedure TfrmPrincipal.Image12Click(Sender: TObject);
begin
  dm.delete
end;

function TfrmPrincipal.Convert(aValor1,aValor2,ResultTrue,ResultFalse: string): string;
begin
  if UpperCase(aValor1) = aValor2 then
    result := ResultTrue
  else
  result := ResultFalse;
end;

procedure TfrmPrincipal.ListBoxItem1Click(Sender: TObject);
begin
  tabC_Princ.ActiveTab := tabPrinc_Teste;
end;

procedure TfrmPrincipal.ListBoxItem_PerfilClick(Sender: TObject);
begin
  MultiView.HideMaster;
  AvancaTela(TabPrinc_Perfil);
end;

procedure TfrmPrincipal.ListBoxItem_LancamentoClick(Sender: TObject);
begin
  MultiView.HideMaster;
  AvancaTela(tabPrinc_Lancamento);
end;

procedure TfrmPrincipal.ListBoxItem_CategoriaClick(Sender: TObject);
begin
  MultiView.HideMaster;
  AvancaTela(tabPrinc_Categoria);
end;

procedure TfrmPrincipal.lstCategoriaItemClickEx(const Sender: TObject;
ItemIndex: Integer; const LocalClickPos: TPointF;
const ItemObject: TListItemDrawable);
begin
  vCadCategriaDesc          := lstCategoria.Items[ItemIndex].Text;
  vCadCategriaId            := lstCategoria.Items[ItemIndex].Detail;
  vCadCategriaInsertUpdate  := dsEdit;
  AvancaTela(tabPrinc_CadCategoria);
end;

procedure TfrmPrincipal.lstPerfilItemClick(const Sender: TCustomListBox;
  const Item: TListBoxItem);
begin
  Item.IsSelected := False;
end;

procedure TfrmPrincipal.MsgInformativaToolb(AMessagem: string);
begin
  ToolBarInformativa.Visible  := true;
  LblTbrInformacao.Text       := AMessagem;
  TimFechaInformacao.Enabled  := true;
end;




function TfrmPrincipal.NomeMes(MesNunber: integer): string;
begin
  case MesNunber of
    1:
      result := 'Janeiro';
    2:
      result := 'Fevereiro';
    3:
      result := 'Macço';
    4:
      result := 'Abril';
    5:
      result := 'Maio';
    6:
      result := 'Julho';
    7:
      result := 'Junho';
    8:
      result := 'Agosto';
    9:
      result := 'Setembro';
    10:
      result := 'Outubro';
    11:
      result := 'Novembro';
    12:
      result := 'Dezembro';
  end;
end;

procedure TfrmPrincipal.rectNovaDespesaClick(Sender: TObject);
begin
  vCadLancTipoCreDeb := 'D';
  AvancarTabsCadLancamento(tabCadLanc_Primaria);

end;

procedure TfrmPrincipal.rectNovaReceitaClick(Sender: TObject);
begin
  vCadLancTipoCreDeb := 'C';
  AvancarTabsCadLancamento(tabCadLanc_Primaria);
end;

procedure TfrmPrincipal.btnAvancarTabSecundariaClick(Sender: TObject);
begin
  uCadLancamento.vCadLancDescricao     := edtCadLancDescricao.Text;
  uCadLancamento.vCadLancValor         := edtCadLancValor.Text;
  uCadLancamento.vCadLancData          := edtCadLancData.Text;
  uCadLancamento.vCadLancDescCategoria := edtCadLancCategoria.Text;

  AvancarTabsCadLancamento(tabCadLanc_Secundaria);
end;

procedure TfrmPrincipal.btnCadLancAvancaDataClick(Sender: TObject);
var
  DataEdt: TDate;
begin
  DataEdt := StrToDate(edtCadLancData.Text);
  edtCadLancData.Text := DateToStr(DataEdt + 1);
end;

procedure TfrmPrincipal.btnCadLancGravarLancClick(Sender: TObject);
begin
  SalvarLancamento;
  AvancaTela(tabPrinc_Home);
end;

procedure TfrmPrincipal.btnCadLancVoltaDataClick(Sender: TObject);
var
  DataEdt: TDate;
begin
  DataEdt := StrToDate(edtCadLancData.Text);
  edtCadLancData.Text := DateToStr(DataEdt - 1);
end;

procedure TfrmPrincipal.btnCadLancVoltarClick(Sender: TObject);
begin
  begin
    case tabcCadLanc.TabIndex of
      0:
      begin
        uControleDeTela.ControlTelaVoltaTela
      end;
      1:
      begin
        AvancarTabsCadLancamento(tabCadLanc_Novo);
      end;
      2:
      begin
        AvancarTabsCadLancamento(tabCadLanc_Primaria);
      end;
      3:
      begin
        AvancarTabsCadLancamento(tabCadLanc_Primaria);
      end;
    end;
  end;
end;


procedure TfrmPrincipal.btnPerfilRefleshDimessaoClick(Sender: TObject);
begin
  edtPerfilDimessao.Text := CapiturarDimessao;
end;

procedure TfrmPrincipal.SpeedButton12Click(Sender: TObject);
begin
  RecuaFiltroMes_Lanc;
end;

procedure TfrmPrincipal.SpeedButton14Click(Sender: TObject);
begin
  AvancarFiltroMes_Lanc;
end;

procedure TfrmPrincipal.SpeedButton1Click(Sender: TObject);
begin
  ControlTelaVoltaTela;
end;

procedure TfrmPrincipal.SpeedButton2Click(Sender: TObject);
begin
  EdtLoginSenha.Text := '';
  actLogin_Logar.ExecuteTarget(self);
end;

procedure TfrmPrincipal.btnLanc_AtivarFiltroClick(Sender: TObject);
begin
  MultiViewLanc_FiltroData.HideMaster;
  HabilitarFiltro_Lanc;
end;

procedure TfrmPrincipal.swiCadLancPagoSwitch(Sender: TObject);
begin
  if swiCadLancPago.IsChecked = True then
    lblCadLancPago.Text := 'Pago'
  else
    lblCadLancPago.Text := 'A pagar'
end;

procedure TfrmPrincipal.btnCadLanc_AmanhaClick(Sender: TObject);
begin
  edtCadLancData.Text :=  DateToStr(now()+ 1);
end;

procedure TfrmPrincipal.btnCadLanc_HojeClick(Sender: TObject);
begin
  edtCadLancData.Text :=  DateToStr(now());
end;

procedure TfrmPrincipal.btnCadLanc_OntemClick(Sender: TObject);
begin
  edtCadLancData.Text :=  DateToStr(now()- 1);
end;

procedure TfrmPrincipal.btnCadLanc_PersonClick(Sender: TObject);
begin
  edtCadLancData.SetFocus;
end;


procedure TfrmPrincipal.btnCategoriaNovaClick(Sender: TObject);
begin
  NovaCategoria;
end;

procedure TfrmPrincipal.btnCategoriaVoltarClick(Sender: TObject);
begin
  ControlTelaVoltaTela;
end;

procedure TfrmPrincipal.btnPerfilEditUsuarioClick(Sender: TObject);
begin
  if btnPerfilEditUsuario.StyleLookup = 'composetoolbutton' then
  begin
    vBkpUsuarioPerfil                 := edtPerfilUsuario.Text;
    edtPerfilUsuario.Enabled          := True;
    edtPerfilUsuario.SetFocus;
    btnPerfilCancUsuario.Visible      := True;
    btnPerfilEditUsuario.StyleLookup  := 'donetoolbutton';
  end
  else
  begin
    edtPerfilUsuario.Enabled          := False;
    dm.EditarUsuarioPerfilDB(edtPerfilUsuario.Text);
    btnPerfilCancUsuario.Visible      := False;
    btnPerfilEditUsuario.StyleLookup  := 'composetoolbutton';
  end;
end;

procedure TfrmPrincipal.btnPerfilEditSenhaClick(Sender: TObject);
begin
 if btnPerfilEditSenha.StyleLookup = 'composetoolbutton' then
  begin
    vBkpSenhaPerfil                   := edtPerfilSenha.Text;
    edtPerfilSenha.Enabled            := True;
    edtPerfilSenha.SetFocus;
    btnPerfilCancSenha.Visible        := True;
    btnPerfilEditSenha.StyleLookup    := 'donetoolbutton';
  end
  else
  begin
    edtPerfilSenha.Enabled            := False;
    dm.EditarSenhaPerfilDB(edtPerfilSenha.Text);
    btnPerfilCancSenha.Visible        := False;
    btnPerfilEditSenha.StyleLookup    := 'composetoolbutton';
  end;
end;


procedure TfrmPrincipal.btnPerfilCancSenhaClick(Sender: TObject);
begin
  edtPerfilSenha.Text                 := vBkpSenhaPerfil;
  edtPerfilSenha.Enabled              := False;
  btnPerfilEditSenha.StyleLookup      := 'composetoolbutton';
  btnPerfilCancSenha.Visible          := False;
end;

procedure TfrmPrincipal.btnPerfilCancUsuarioClick(Sender: TObject);
begin
  edtPerfilUsuario.Text               := vBkpUsuarioPerfil;
  edtPerfilUsuario.Enabled            := False;
  btnPerfilEditUsuario.StyleLookup    := 'composetoolbutton';
  btnPerfilCancUsuario.Visible        := False;
end;

procedure TfrmPrincipal.BtnPerfilLogoffClick(Sender: TObject);
begin
  _uDmProcedures.UpdateUsuarioCadastrado('N');
  uControleDeTela.AvancaTela(tabPrinc_Login);
end;

procedure TfrmPrincipal.btnSalvarCategoria_CadLancClick(Sender: TObject);
begin
  vCadLancDescCategoria := lstCategoriaCadLanc.Items[lstCategoriaCadLanc.ItemIndex];
  vCadLancIdCategoria   := IntToStr(integer(lstCategoriaCadLanc.Items.Objects[lstCategoriaCadLanc.ItemIndex]));

  AvancarTabsCadLancamento(tabCadLanc_Primaria);
end;

procedure TfrmPrincipal.btnToolBarNovoCategoriaClick(Sender: TObject);
begin
  if TabC_Princ.ActiveTab = TabPrinc_CadLancamento then
    if tabcCadLanc.ActiveTab = tabCadLanc_categoria then
    begin
      NovaCategoria;
    end;
end;

procedure TfrmPrincipal.Button1Click(Sender: TObject);
begin
  actPrinc_Lancamento.ExecuteTarget(self);
  actTabLanc_Lancamento.ExecuteTarget(self);
end;

procedure TfrmPrincipal.Button2Click(Sender: TObject);
begin
   actPrinc_Lancamento.ExecuteTarget(self);
  actTabLanc_Resumo.ExecuteTarget(self);
end;

procedure TfrmPrincipal.Button3Click(Sender: TObject);
begin
   actPrinc_Lancamento.ExecuteTarget(self);
  actTabLanc_Despesa.ExecuteTarget(self);
end;

procedure TfrmPrincipal.Button4Click(Sender: TObject);
begin
  actPrinc_Lancamento.ExecuteTarget(self);
  actTabLanc_Receita.ExecuteTarget(self);
end;

procedure TfrmPrincipal.BtnHomeVoltaMesClick(Sender: TObject);
begin

  vMes := vMes - 1;
  if vMes = 0 then
  begin
    vMes := 12;
    vAno := vAno - 1;
  end;

end;

procedure TfrmPrincipal.lblLoginCriaNovaContaClick(Sender: TObject);
begin
  EdtCadLoginNone.Text        := '';
  edtCadLoginSenha.Text       := '';
  edtCadLoginConfiSenha.Text  := '';

  actLogin_CadUsuario.ExecuteTarget(nil);
end;



procedure TfrmPrincipal.BtnHomeAvancaMesClick(Sender: TObject);
begin
  vMes := vMes + 1;
  if vMes > 12 then
  begin
    vMes := 1;
    vAno := vAno + 1;
  end;
  //AtualTabiHome;
end;

procedure TfrmPrincipal.TimFechaInformacaoTimer(Sender: TObject);
begin
  ToolBarInformativa.Visible := false;
  TimFechaInformacao.Enabled := false;
end;


procedure TfrmPrincipal.BtnLancamentoVoltaMesClick(Sender: TObject);
begin
  vMes := vMes - 1;
  if vMes = 0 then
  begin
    vMes := 12;
    vAno := vAno - 1;
  end;
  //AtualLstLacanmentoTabiLancamento;
end;


procedure TfrmPrincipal.BtnLancamentoAvancaMesClick(Sender: TObject);
begin
  vMes := vMes + 1;
  if vMes > 12 then
  begin
    vMes := 1;
    vAno := vAno + 1;
  end;
  //AtualLstLacanmentoTabiLancamento;
end;

procedure TfrmPrincipal.imgBtnNovoLancamentoClick(Sender: TObject);
begin
  vCadLancInsertUpdate := dsInsert;
  uCadLancamento.IniciaCadLancamento;
  uControleDeTela.AvancaTela(TabPrinc_CadLancamento);
end;

function TfrmPrincipal.FormateReal(AValorEntrada: string): string;
begin
  if pos(',', AValorEntrada) > 0 then
    AValorEntrada := StringReplace(AValorEntrada, ',', '', [rfReplaceAll])
  else if pos('.', AValorEntrada) > 0 then
    AValorEntrada := StringReplace(AValorEntrada, '.', '', [rfReplaceAll])
  else
    AValorEntrada := AValorEntrada + '00';

  result := FormatFloat('###0.00', StrToFloat(AValorEntrada) / 100);
end;

procedure TfrmPrincipal.FormCloseQuery(Sender: TObject; var CanClose: Boolean);
begin
  Application.Terminate;
end;

procedure TfrmPrincipal.FormCreate(Sender: TObject);
begin

  TabC_Princ.TabPosition        := TTabPosition.None;
  TabC_Princ.ActiveTab          := tabPrinc_Login;

  tabcLogin.TabPosition         := TTabPosition.None;
  tabcLogin.ActiveTab           := tabLogin_Logar;

  tabcCadLanc.TabPosition       := TTabPosition.None;

  toolBarInformativa.Visible    := False;

  MultiView.Enabled             := False;

  imgUltimoLancDespesa.Visible  := False;
  imgUltimoLancReceita.Visible  := False;

  btnToolBarNovoCategoria.Visible := False;
end;

procedure TfrmPrincipal.FormKeyUp(Sender: TObject; var Key: Word;
var KeyChar: Char; Shift: TShiftState);
{$IFDEF ANDROID}
var
  Fservice: IFMXVirtualKeyboardService;
{$ENDIF}
begin
{$IFDEF ANDROID}
  If (Key = vkHardwareBack) then
  begin
    TPlatformServices.Current.SupportsPlatformService
      (IFMXVirtualKeyboardService, IInterface(Fservice));

    If (Fservice <> nil) and (TVirtualKeyboardState.Visible
                                in Fservice.VirtualKeyBoardState) then
    Begin
      //QUANDO O TECLADO ESTIVER ABERTO FECHA O TECLADO
    end
    Else
      if tabC_Princ.ActiveTab <> tabPrinc_Home then
      begin
        Key := 0;
        ControlTelaVoltaTela;
      end;
  end;
{      Else
      begin
        If MessageDlg('Deseja realmente fechar a aplicação?',
                      TMsgDlgType.mtConfirmation,[TMsgDlgBtn.mbYes, TMsgDlgBtn.mbNo], 0,
                      TMsgDlgBtn.mbNo) = mrYes  then
        begin
          exit
        end
        else
          Key := 0;
        end;
      end;}
{$ENDIF}
end;

function TfrmPrincipal.DataSqlLite(Adata: TDateTime): string;
begin
  result := FormatDateTime('dd/mm/yyyy', Adata);
end;


procedure TfrmPrincipal.edtCadLancCategoriaClick(Sender: TObject);
begin
  AvancarTabsCadLancamento(tabCadLanc_Categoria);
end;

procedure TfrmPrincipal.EdtCadCategoriaDescExit(Sender: TObject);
begin
  EdtCadCategoriaDesc.Text := UpperCase(EdtCadCategoriaDesc.Text);
end;



procedure TfrmPrincipal.EdtCadLancaValorKeyDown(Sender: TObject; var Key: Word;
var KeyChar: Char; Shift: TShiftState);
begin
  if not(KeyChar in ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0', ','])
  then
    KeyChar := #0;
end;

procedure TfrmPrincipal.edtCadLancDataChange(Sender: TObject);
begin
  vCadLancData := edtCadLancData.Text;
  ControleBotaoTabDataCadLanc(edtCadLancData.Text);
end;


procedure TfrmPrincipal.edtCadLancDataExit(Sender: TObject);
begin
  vCadLancData := edtCadLancData.Text;
end;

procedure TfrmPrincipal.edtCadLancDescricaoExit(Sender: TObject);
begin
  vCadLancDescricao := UpperCase(edtCadLancDescricao.text);
end;

procedure TfrmPrincipal.edtCadLancValorExit(Sender: TObject);
begin
  vCadLancValor := UpperCase(edtCadLancValor.Text);
end;

procedure TfrmPrincipal.edtCadLancValorKeyDown(Sender: TObject; var Key: Word;
  var KeyChar: Char; Shift: TShiftState);
begin
If not(keychar in['0'..'9',',',#08]) then
  KeyChar:=#0;
end;

procedure TfrmPrincipal.btnAcessarClick(Sender: TObject);
begin
   if uLogin.ValidaSenhaUsuario(EdtLoginSenha.Text) then
    begin
      _uDmProcedures.UpdateUsuarioCadastrado('S');
      uControleDeTela.AvancaTela(tabPrinc_Home);
    end
    else
    begin
      MsgInformativaToolb('Informe a senha.');
      EdtLoginSenha.SetFocus;
    end;
end;

procedure TfrmPrincipal.btnCadastarUsuarioClick(Sender: TObject);
begin
  if EdtCadLoginNone.Text = '' then
  begin
    MsgInformativaToolb('Informe o nome do usuario');
    exit
  end
  else
    if edtCadLoginSenha.Text = '' then
    begin
      MsgInformativaToolb('Informe a senha');
      exit
    end
    else
      if edtCadLoginSenha.Text <> edtCadLoginConfiSenha.text then
      begin
        MsgInformativaToolb('A senha nao conferi com a digita');
        exit
      end
      else
      begin
        Dm.GravarUsuarioDBCadUsuario;
        EdtLoginSenha.text := '';
        EdtLoginSenha.SetFocus;
        AvancaTela(tabPrinc_Login);
      end;
end;


procedure TfrmPrincipal.BtnCadCategoriaExcluiClick(Sender: TObject);
begin
  dm.DeleterCategoriaDB;
  ControlTelaVoltaTela;
end;

procedure TfrmPrincipal.BtnCadCategoriaSalvaClick(Sender: TObject);
begin
  vCadCategriaDesc := UpperCase(EdtCadCategoriaDesc.Text);
  SalvaCategoria;
  ControlTelaVoltaTela;
end;

procedure TfrmPrincipal.btnCadCategoriaVoltarClick(Sender: TObject);
begin
  if tabcCadLanc.ActiveTab = tabCadLanc_categoria then
    RefresherLstCategoriaCadLanc;

  ControlTelaVoltaTela;
end;
end.
