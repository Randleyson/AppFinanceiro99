{$A8,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N-,O+,P+,Q-,R-,S-,T-,U-,V+,W-,X+,Y+,Z1}
{$MINSTACKSIZE $00004000}
{$MAXSTACKSIZE $00100000}
{$IMAGEBASE $00400000}
{$APPTYPE GUI}
{$WARN SYMBOL_DEPRECATED ON}
{$WARN SYMBOL_LIBRARY ON}
{$WARN SYMBOL_PLATFORM ON}
{$WARN SYMBOL_EXPERIMENTAL ON}
{$WARN UNIT_LIBRARY ON}
{$WARN UNIT_PLATFORM ON}
{$WARN UNIT_DEPRECATED ON}
{$WARN UNIT_EXPERIMENTAL ON}
{$WARN HRESULT_COMPAT ON}
{$WARN HIDING_MEMBER ON}
{$WARN HIDDEN_VIRTUAL ON}
{$WARN GARBAGE ON}
{$WARN BOUNDS_ERROR ON}
{$WARN ZERO_NIL_COMPAT ON}
{$WARN STRING_CONST_TRUNCED ON}
{$WARN FOR_LOOP_VAR_VARPAR ON}
{$WARN TYPED_CONST_VARPAR ON}
{$WARN ASG_TO_TYPED_CONST ON}
{$WARN CASE_LABEL_RANGE ON}
{$WARN FOR_VARIABLE ON}
{$WARN CONSTRUCTING_ABSTRACT ON}
{$WARN COMPARISON_FALSE ON}
{$WARN COMPARISON_TRUE ON}
{$WARN COMPARING_SIGNED_UNSIGNED ON}
{$WARN COMBINING_SIGNED_UNSIGNED ON}
{$WARN UNSUPPORTED_CONSTRUCT ON}
{$WARN FILE_OPEN ON}
{$WARN FILE_OPEN_UNITSRC ON}
{$WARN BAD_GLOBAL_SYMBOL ON}
{$WARN DUPLICATE_CTOR_DTOR ON}
{$WARN INVALID_DIRECTIVE ON}
{$WARN PACKAGE_NO_LINK ON}
{$WARN PACKAGED_THREADVAR ON}
{$WARN IMPLICIT_IMPORT ON}
{$WARN HPPEMIT_IGNORED ON}
{$WARN NO_RETVAL ON}
{$WARN USE_BEFORE_DEF ON}
{$WARN FOR_LOOP_VAR_UNDEF ON}
{$WARN UNIT_NAME_MISMATCH ON}
{$WARN NO_CFG_FILE_FOUND ON}
{$WARN IMPLICIT_VARIANTS ON}
{$WARN UNICODE_TO_LOCALE ON}
{$WARN LOCALE_TO_UNICODE ON}
{$WARN IMAGEBASE_MULTIPLE ON}
{$WARN SUSPICIOUS_TYPECAST ON}
{$WARN PRIVATE_PROPACCESSOR ON}
{$WARN UNSAFE_TYPE OFF}
{$WARN UNSAFE_CODE OFF}
{$WARN UNSAFE_CAST OFF}
{$WARN OPTION_TRUNCATED ON}
{$WARN WIDECHAR_REDUCED ON}
{$WARN DUPLICATES_IGNORED ON}
{$WARN UNIT_INIT_SEQ ON}
{$WARN LOCAL_PINVOKE ON}
{$WARN MESSAGE_DIRECTIVE ON}
{$WARN TYPEINFO_IMPLICITLY_ADDED ON}
{$WARN RLINK_WARNING ON}
{$WARN IMPLICIT_STRING_CAST ON}
{$WARN IMPLICIT_STRING_CAST_LOSS ON}
{$WARN EXPLICIT_STRING_CAST OFF}
{$WARN EXPLICIT_STRING_CAST_LOSS OFF}
{$WARN CVT_WCHAR_TO_ACHAR ON}
{$WARN CVT_NARROWING_STRING_LOST ON}
{$WARN CVT_ACHAR_TO_WCHAR ON}
{$WARN CVT_WIDENING_STRING_LOST ON}
{$WARN NON_PORTABLE_TYPECAST ON}
{$WARN XML_WHITESPACE_NOT_ALLOWED ON}
{$WARN XML_UNKNOWN_ENTITY ON}
{$WARN XML_INVALID_NAME_START ON}
{$WARN XML_INVALID_NAME ON}
{$WARN XML_EXPECTED_CHARACTER ON}
{$WARN XML_CREF_NO_RESOLVE ON}
{$WARN XML_NO_PARM ON}
{$WARN XML_NO_MATCHING_PARM ON}
{$WARN IMMUTABLE_STRINGS OFF}
{$A8,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N-,O+,P+,Q-,R-,S-,T-,U-,V+,W-,X+,Y+,Z1}
{$MINSTACKSIZE $00004000}
{$MAXSTACKSIZE $00100000}
{$IMAGEBASE $00400000}
{$APPTYPE GUI}
{$WARN SYMBOL_DEPRECATED ON}
{$WARN SYMBOL_LIBRARY ON}
{$WARN SYMBOL_PLATFORM ON}
{$WARN SYMBOL_EXPERIMENTAL ON}
{$WARN UNIT_LIBRARY ON}
{$WARN UNIT_PLATFORM ON}
{$WARN UNIT_DEPRECATED ON}
{$WARN UNIT_EXPERIMENTAL ON}
{$WARN HRESULT_COMPAT ON}
{$WARN HIDING_MEMBER ON}
{$WARN HIDDEN_VIRTUAL ON}
{$WARN GARBAGE ON}
{$WARN BOUNDS_ERROR ON}
{$WARN ZERO_NIL_COMPAT ON}
{$WARN STRING_CONST_TRUNCED ON}
{$WARN FOR_LOOP_VAR_VARPAR ON}
{$WARN TYPED_CONST_VARPAR ON}
{$WARN ASG_TO_TYPED_CONST ON}
{$WARN CASE_LABEL_RANGE ON}
{$WARN FOR_VARIABLE ON}
{$WARN CONSTRUCTING_ABSTRACT ON}
{$WARN COMPARISON_FALSE ON}
{$WARN COMPARISON_TRUE ON}
{$WARN COMPARING_SIGNED_UNSIGNED ON}
{$WARN COMBINING_SIGNED_UNSIGNED ON}
{$WARN UNSUPPORTED_CONSTRUCT ON}
{$WARN FILE_OPEN ON}
{$WARN FILE_OPEN_UNITSRC ON}
{$WARN BAD_GLOBAL_SYMBOL ON}
{$WARN DUPLICATE_CTOR_DTOR ON}
{$WARN INVALID_DIRECTIVE ON}
{$WARN PACKAGE_NO_LINK ON}
{$WARN PACKAGED_THREADVAR ON}
{$WARN IMPLICIT_IMPORT ON}
{$WARN HPPEMIT_IGNORED ON}
{$WARN NO_RETVAL ON}
{$WARN USE_BEFORE_DEF ON}
{$WARN FOR_LOOP_VAR_UNDEF ON}
{$WARN UNIT_NAME_MISMATCH ON}
{$WARN NO_CFG_FILE_FOUND ON}
{$WARN IMPLICIT_VARIANTS ON}
{$WARN UNICODE_TO_LOCALE ON}
{$WARN LOCALE_TO_UNICODE ON}
{$WARN IMAGEBASE_MULTIPLE ON}
{$WARN SUSPICIOUS_TYPECAST ON}
{$WARN PRIVATE_PROPACCESSOR ON}
{$WARN UNSAFE_TYPE OFF}
{$WARN UNSAFE_CODE OFF}
{$WARN UNSAFE_CAST OFF}
{$WARN OPTION_TRUNCATED ON}
{$WARN WIDECHAR_REDUCED ON}
{$WARN DUPLICATES_IGNORED ON}
{$WARN UNIT_INIT_SEQ ON}
{$WARN LOCAL_PINVOKE ON}
{$WARN MESSAGE_DIRECTIVE ON}
{$WARN TYPEINFO_IMPLICITLY_ADDED ON}
{$WARN RLINK_WARNING ON}
{$WARN IMPLICIT_STRING_CAST ON}
{$WARN IMPLICIT_STRING_CAST_LOSS ON}
{$WARN EXPLICIT_STRING_CAST OFF}
{$WARN EXPLICIT_STRING_CAST_LOSS OFF}
{$WARN CVT_WCHAR_TO_ACHAR ON}
{$WARN CVT_NARROWING_STRING_LOST ON}
{$WARN CVT_ACHAR_TO_WCHAR ON}
{$WARN CVT_WIDENING_STRING_LOST ON}
{$WARN NON_PORTABLE_TYPECAST ON}
{$WARN XML_WHITESPACE_NOT_ALLOWED ON}
{$WARN XML_UNKNOWN_ENTITY ON}
{$WARN XML_INVALID_NAME_START ON}
{$WARN XML_INVALID_NAME ON}
{$WARN XML_EXPECTED_CHARACTER ON}
{$WARN XML_CREF_NO_RESOLVE ON}
{$WARN XML_NO_PARM ON}
{$WARN XML_NO_MATCHING_PARM ON}
{$WARN IMMUTABLE_STRINGS OFF}
unit uFrmPrincipal;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes,
  System.Variants,
  FMX.Types, FMX.Controls, FMX.Forms, FMX.Graphics, FMX.Dialogs, FMX.Objects,
  FMX.TabControl, FMX.StdCtrls, FMX.Edit, FMX.Controls.Presentation,
  FMX.Layouts,
  System.Actions, FMX.ActnList, FMX.ListBox, FMX.MultiView, FMX.ListView.Types,
  FMX.ListView.Appearances, FMX.ListView.Adapters.Base, FMX.ListView, db,
  MultiDetailAppearanceU, System.ImageList, FMX.ImgList, DateUtils,
  FMX.DateTimeCtrls, System.UIConsts, FMX.VirtualKeyboard, FMX.Platform,
  FGX.ActionSheet, System.IOUtils, System.StrUtils, FMX.ComboEdit,
  FMX.ComboTrackBar, FMX.Ani, FMX.Effects, FMX.Filter.Effects,uDatamodule



{$IFDEF ANDROID}
    , FMX.Helpers.Android, FMX.Platform.Android
{$ENDIF}
    ;

type
  TfrmPrincipal = class(TForm)
    tabcPrinc: TTabControl;
    tabPrinc_Login: TTabItem;
    tabPrinc_Home: TTabItem;
    RectLogin: TRectangle;
    ImgLoginLogo: TImage;
    Layout1: TLayout;
    EdtLoginSenha: TEdit;
    StyleBook1: TStyleBook;
    MultiView: TMultiView;
    Rectangle3: TRectangle;
    Image2: TImage;
    ListBox1: TListBox;
    listBoxPaine: TListBoxItem;
    ListBoxLancamento: TListBoxItem;
    ListBoxCategoria: TListBoxItem;
    ListBoxPerfil: TListBoxItem;
    tabPrinc_Lancamento: TTabItem;
    RectLancFiltro: TRectangle;
    lblData: TLabel;
    BtnLancamentoVoltaMes: TSpeedButton;
    BtnLancamentoAvancaMes: TSpeedButton;
    Layout6: TLayout;
    Layout7: TLayout;
    lblTotalReceita: TLabel;
    Label10: TLabel;
    Layout8: TLayout;
    lblTotalDespesa: TLabel;
    Label12: TLabel;
    tabPrinc_Categoria: TTabItem;
    ToolBar3: TToolBar;
    Label13: TLabel;
    BtnCategoriaVolta: TSpeedButton;
    BtnCategoriaAdd: TSpeedButton;
    tabPrinc_CadCategoria: TTabItem;
    ToolBar4: TToolBar;
    Label14: TLabel;
    BtnCadCategoriaVolta: TSpeedButton;
    BtnCadCategoriaSalva: TSpeedButton;
    Label15: TLabel;
    EdtCadCategoriaDesc: TEdit;
    LstLancamento: TListView;
    ListCategoria: TListView;
    BtnCadCategoriaExclui: TSpeedButton;
    TabPrinc_Perfil: TTabItem;
    ToolBar5: TToolBar;
    BtnPerfilVolta: TSpeedButton;
    Rectangle7: TRectangle;
    Label16: TLabel;
    Label17: TLabel;
    ListBox2: TListBox;
    ListBoxItem1: TListBoxItem;
    ListBoxItem3: TListBoxItem;
    tabPrinc_Idiona: TTabItem;
    ToolBar6: TToolBar;
    Label18: TLabel;
    BtnConfigVolta: TSpeedButton;
    BtnConfigSalva: TSpeedButton;
    ListBox3: TListBox;
    ListBoxItem2: TListBoxItem;
    ListBoxItem4: TListBoxItem;
    ListBox4: TListBox;
    ListBoxItem5: TListBoxItem;
    ListBoxItem6: TListBoxItem;
    lblLoginCriaNovaConta: TLabel;
    Layout9: TLayout;
    EdtCadLoginNone: TEdit;
    edtCadLoginSenha: TEdit;
    edtCadLoginConfiSenha: TEdit;
    ToolBar10: TToolBar;
    Label23: TLabel;
    SpeedButton2: TSpeedButton;
    rectBtnAcessar: TRectangle;
    toobInformativa: TToolBar;
    LblTbrInformacao: TLabel;
    TimFechaInformacao: TTimer;
    rectBtnCadUsuario: TRectangle;
    Layout10: TLayout;
    BtnHomeMenu: TSpeedButton;
    Rectangle1: TRectangle;
    ToolBar11: TToolBar;
    Rectangle11: TRectangle;
    Label36: TLabel;
    BtnLancamentoVolta: TSpeedButton;
    LayListaLanc: TLayout;
    Rectangle5: TRectangle;
    Rectangle6: TRectangle;
    Rectangle10: TRectangle;
    ImgLstLogo: TImageList;
    lblNomeDoUsuario: TLabel;
    Label1: TLabel;
    lblSaldoAtual: TLabel;
    RectPerfilLogoff: TRectangle;
    Circle1: TCircle;
    RectPerfilBtnAlterSenha: TRectangle;
    Rectangle8: TRectangle;
    Line3: TLine;
    BtnLancamentoAdd: TSpeedButton;
    fgActNovoLanca: TfgActionSheet;
    TabPrinc_CadLancamento: TTabItem;
    LayLancFiltro: TLayout;
    Layout23: TLayout;
    rectToolBarCadLancamento: TRectangle;
    SpeedButton1: TSpeedButton;
    btnCadLancExcluir: TSpeedButton;
    tabcCadLanc: TTabControl;
    tabCadLanc_Inicio: TTabItem;
    tabCadLanc_Descricao: TTabItem;
    Rectangle18: TRectangle;
    lblDescricao: TLabel;
    edtCadLancDescricao: TEdit;
    lblTituloCadLancamento: TLabel;
    Rectangle20: TRectangle;
    Layout16: TLayout;
    actTabPrincipal: TActionList;
    actPrinc_CadLancamento: TChangeTabAction;
    actPrinc_Home: TChangeTabAction;
    actPrinc_Login: TChangeTabAction;
    tabCadLanc_Valor: TTabItem;
    tabCadLanc_Data: TTabItem;
    tabCadLanc_nroParce: TTabItem;
    tabCadLanc_Quitada: TTabItem;
    tabCadLanc_Categoria: TTabItem;
    edtCadLancValor: TEdit;
    Layout17: TLayout;
    Rectangle9: TRectangle;
    Rectangle17: TRectangle;
    Label6: TLabel;
    Layout18: TLayout;
    Rectangle19: TRectangle;
    Rectangle21: TRectangle;
    lblDataCadLanc: TLabel;
    Layout19: TLayout;
    Rectangle22: TRectangle;
    Rectangle23: TRectangle;
    Label20: TLabel;
    Layout20: TLayout;
    Rectangle24: TRectangle;
    Rectangle25: TRectangle;
    Label22: TLabel;
    Layout21: TLayout;
    Rectangle26: TRectangle;
    Rectangle27: TRectangle;
    Label27: TLabel;
    ctbNroPracela: TComboTrackBar;
    cboxQuitada: TComboBox;
    cboxCategriaCadLanc: TComboBox;
    actTabCadLanc: TActionList;
    actCadLanc_inicio: TChangeTabAction;
    actCadLanc_Descricao: TChangeTabAction;
    actCadLanc_Valor: TChangeTabAction;
    actCadLanc_Data: TChangeTabAction;
    actCadLanc_NroParcela: TChangeTabAction;
    actCadLanc_Quitada: TChangeTabAction;
    actCadLanc_Categoria: TChangeTabAction;
    SpeedButton3: TSpeedButton;
    Layout22: TLayout;
    Layout24: TLayout;
    SpeedButton4: TSpeedButton;
    Layout25: TLayout;
    SpeedButton5: TSpeedButton;
    Layout26: TLayout;
    SpeedButton6: TSpeedButton;
    Layout27: TLayout;
    SpeedButton7: TSpeedButton;
    Layout28: TLayout;
    SpeedButton8: TSpeedButton;
    edtCadLancData: TDateEdit;
    Layout29: TLayout;
    SpeedButton10: TSpeedButton;
    actPrinc_CadCategoria: TChangeTabAction;
    actPrinc_Categoria: TChangeTabAction;
    imglstIcoBtn: TImageList;
    actPrinc_Lancamento: TChangeTabAction;
    actPrinc_Perfil: TChangeTabAction;
    tabPrinc_Teste: TTabItem;
    btnAcessar: TSpeedButton;
    TabcLogin: TTabControl;
    tabLogin_Logar: TTabItem;
    tabLogin_CadUsuario: TTabItem;
    btnCadastarUsuario: TSpeedButton;
    btnAvancarDescricao: TSpeedButton;
    btnAvancarValor: TSpeedButton;
    btnAvancarData: TSpeedButton;
    btnAvancarNroParcela: TSpeedButton;
    btnAvancarQuitadado: TSpeedButton;
    btnSalvarCadLancamento: TSpeedButton;
    BtnAlterSenha: TSpeedButton;
    BtnPerfilLogoff: TSpeedButton;
    actTabLogin: TActionList;
    actLogin_Logar: TChangeTabAction;
    actLogin_CadUsuario: TChangeTabAction;
    Image1: TImage;
    lblUsuarioLogin: TLabel;
    Rectangle29: TRectangle;
    rectHomeTop: TRectangle;
    Layout30: TLayout;
    Image4: TImage;
    Layout31: TLayout;
    Image5: TImage;
    Layout32: TLayout;
    Label2: TLabel;
    Layout33: TLayout;
    Rectangle30: TRectangle;
    Layout34: TLayout;
    lblDataAtualtabiHome: TLabel;
    Layout36: TLayout;
    lblSaldoAtualLinhaTempo: TLabel;
    lblSaldoRestanteLinhaTempo: TLabel;
    lblApagarLinhaTempo: TLabel;
    lblAreceberLinhaTempo: TLabel;
    Rectangle31: TRectangle;
    Rectangle32: TRectangle;
    ShadowEffect2: TShadowEffect;
    ShadowEffect3: TShadowEffect;
    lytUltimoLancamento: TLayout;
    Layout37: TLayout;
    Label37: TLabel;
    SpeedButton11: TSpeedButton;
    Label38: TLabel;
    Layout35: TLayout;
    Image3: TImage;
    Image6: TImage;
    Image7: TImage;
    Image8: TImage;
    Line1: TLine;
    Line4: TLine;
    Line5: TLine;
    BlurEffect1: TBlurEffect;
    lstUltimoLanc: TListView;
    imgUltimoLancDespesa: TImage;
    imgUltimoLancReceita: TImage;
    lytMenuHome: TLayout;
    Layout3: TLayout;
    Image10: TImage;
    Layout4: TLayout;
    Image11: TImage;
    Layout5: TLayout;
    Image12: TImage;
    Layout2: TLayout;
    Image9: TImage;
    tabCadLanc_NovoLanc: TTabItem;
    Rectangle2: TRectangle;
    Rectangle4: TRectangle;
    Rectangle12: TRectangle;
    Rectangle13: TRectangle;
    Layout11: TLayout;
    Layout12: TLayout;
    Image13: TImage;
    Image14: TImage;
    rectNovaReceita: TRectangle;
    rectNovaDespesa: TRectangle;
    Label3: TLabel;
    Label4: TLabel;
    ShadowEffect1: TShadowEffect;
    BandsEffect1: TBandsEffect;
    actCadLanc_Novo: TChangeTabAction;
    lstCadLancamento: TListView;
    Rectangle14: TRectangle;
    ShadowEffect4: TShadowEffect;
    ImgCadLancInterogacao: TImage;
    procedure ListBoxLancamentoClick(Sender: TObject);
    procedure BtnCategoriaAddClick(Sender: TObject);
//    procedure BtnCadCategoriaVoltaClick(Sender: TObject);
    procedure ListBoxCategoriaClick(Sender: TObject);
    procedure ListCategoriaItemClickEx(const Sender: TObject;
      ItemIndex: Integer; const LocalClickPos: TPointF;
      const ItemObject: TListItemDrawable);
//    procedure BtnCadCategoriaSalvaClick(Sender: TObject);
//    procedure BtnCadCategoriaExcluiClick(Sender: TObject);
    procedure ListBoxPerfilClick(Sender: TObject);
    procedure BtnLancamentoVoltaMesClick(Sender: TObject);
    procedure BtnLancamentoAvancaMesClick(Sender: TObject);
    procedure lblLoginCriaNovaContaClick(Sender: TObject);
    procedure TimFechaInformacaoTimer(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure listBoxPaineClick(Sender: TObject);
    procedure BtnHomeLancDespesaClick(Sender: TObject);
    procedure FormKeyUp(Sender: TObject; var Key: Word; var KeyChar: Char;
      Shift: TShiftState);
    procedure EdtCadLancaValorKeyDown(Sender: TObject; var Key: Word;
      var KeyChar: Char; Shift: TShiftState);
    procedure EdtCadCategoriaDescExit(Sender: TObject);
    procedure LstLancamentoItemClickEx(const Sender: TObject;
      ItemIndex: Integer; const LocalClickPos: TPointF;
      const ItemObject: TListItemDrawable);
    procedure BtnCadLancamentoVoltaClick(Sender: TObject);
    procedure BtnLancExcluirClick(Sender: TObject);
    procedure BtnLancamentoAddClick(Sender: TObject);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean);
    procedure FormCreate(Sender: TObject);
    procedure BtnHomeVoltaMesClick(Sender: TObject);
    procedure BtnHomeAvancaMesClick(Sender: TObject);
    procedure BtnHomeHomeClick(Sender: TObject);
    procedure lblBtnContasApagarClick(Sender: TObject);
    procedure lblBtnContasAreceberClick(Sender: TObject);
    procedure lblBtnAnteriorClick(Sender: TObject);
    procedure lblBtnHojeClick(Sender: TObject);
    procedure lblBtnProxinoClick(Sender: TObject);
    procedure BtnHabilitaFiltroHomeClick(Sender: TObject);
    procedure lstCadLancamento_oldItemClickEx(const Sender: TObject;
      ItemIndex: Integer; const LocalClickPos: TPointF;
      const ItemObject: TListItemDrawable);
    procedure btnAvancarQuitadadoClick(Sender: TObject);
    procedure SpeedButton1Click(Sender: TObject);
    procedure SpeedButton4Click(Sender: TObject);
    procedure SpeedButton3Click(Sender: TObject);
    procedure SpeedButton5Click(Sender: TObject);
    procedure SpeedButton6Click(Sender: TObject);
    procedure SpeedButton7Click(Sender: TObject);
    procedure SpeedButton8Click(Sender: TObject);
    procedure edtCadLancValorKeyDown(Sender: TObject; var Key: Word;
      var KeyChar: Char; Shift: TShiftState);
    procedure SpeedButton10Click(Sender: TObject);
    procedure edtCadLancDescricaoExit(Sender: TObject);
    procedure BtnHomeLancReceitaClick(Sender: TObject);
    procedure BtnCategoriaVoltaClick(Sender: TObject);
    procedure BtnLancamentoVoltaClick(Sender: TObject);
    procedure BtnHomeNotificacaoClick(Sender: TObject);
    procedure FormResize(Sender: TObject);
    procedure btnAcessarClick(Sender: TObject);
    procedure btnCadastarUsuarioClick(Sender: TObject);
    procedure btnAvancarDescricaoClick(Sender: TObject);
    procedure btnAvancarValorClick(Sender: TObject);
    procedure btnAvancarDataClick(Sender: TObject);
    procedure btnAvancarNroParcelaClick(Sender: TObject);
    procedure btnSalvarCadLancamentoClick(Sender: TObject);
    procedure BtnPerfilLogoffClick(Sender: TObject);
    procedure BtnPerfilVoltaClick(Sender: TObject);
    procedure SpeedButton2Click(Sender: TObject);
    procedure EdtCadLoginNoneExit(Sender: TObject);
    procedure edtCadLoginSenhaExit(Sender: TObject);
    procedure edtCadLoginConfiSenhaExit(Sender: TObject);
    procedure Image9Click(Sender: TObject);
    procedure rectNovaReceitaClick(Sender: TObject);
    procedure rectNovaDespesaClick(Sender: TObject);
    procedure lstCadLancamentoItemClickEx(const Sender: TObject;
      ItemIndex: Integer; const LocalClickPos: TPointF;
      const ItemObject: TListItemDrawable);

  private
    { Private declarations }

    vModulo:              TDataSetState;
    vIdCategoriaEditar:   string;
    vModuloCadCategoria:  TDataSetState;
    vTipoFiltro:          string;
    vMes, vAno:           Integer;
    vTipoLancameto:       string;

//  Variavel Tela cadLancamento:
    vIDcbxCategoria:          array [0 .. 255] of integer;
    vValidaCampoCadLanc:      Boolean;
    vEdtDescCadLanc:          string;
    vEdtVlrCadLanc:           string;
    vEdtDataCadLanc:          string;
    vEdtNroParCadLanc:        string;
    vEdtQuitaCadLanc:         string; //(S/N)
    vEdtCategCadLanc:         string;

    vDetal2DescLstCadLanca:   string;
    vDetal2LstCadLancaVlr:    string;
    vDetal2LstCadLancaDate:   string;
    vDetal2LstCadLancaNroPar: string;
    vDetal2LstCadLancaQuita:  string;
    vDetal2LstCadLancaCateg:  string;



    procedure AtualCboxQuitadoCadLancamento;



    procedure IniciaNovoLancamento(DC : string);

    procedure LimpavDetal2LstCadLanc;
    procedure ValidaCampoCadLanc;
    procedure SairTelaDescricaoCadLancamento;
    procedure SairTelaValorCadLancamento;
    procedure SairTelaDataCadLancamento;
    procedure SairTelaNroParcelaCadLancamento;
    procedure SairTelaQuitadoCadLancamento;
    procedure SairTelaCategoriaCadLancamento;
    procedure EfeitoBtnApagarReceber(Botao: TRectangle);
    procedure EfeitoBtnFiltro(Botaofiltro: TRectangle);
    procedure FiltrolstContaAberta(status: string);
    procedure AlteracaodimensaoDaTela;
    procedure EnviaLancamentoParaEdicao(LstView1:TListView; indexLst: integer);

    function DataSqlLite(Adata: TDateTime): string;


//  procedure AtualTabiHome;
//  procedure SalvaCadLancamento;
//  procedure IrParaTela(NomeTabi: TTabItem);
//  procedure ValidaSenhaUsuario;
//  procedure UsuarioCadastro;
//  procedure CarregaCamposLancamento(LstVeiw: TListView; indexLst: integer);
//  function ExisteUsuarioLogado: Boolean;
//  function ValidaSenhaUsuario: boolean;
//  procedure AtualLstLacanmentoTabiLancamento;
//  procedure AtualLstContaAbertaTabiHome;
//  procedure AtualLstCategoriaTabiCategoria;
//  procedure AtualLstCadLancamento;
//  procedure AtualCboxCategoriaCadLancamento;
//  procedure CadastrarUsuario;
//  procedure updateTabConfigInd_Login(logado: string);
//  function GeraNovoIdTabela(ATabela, ACampoChave: string): Integer;


  public
    { Public declarations }

  procedure MsgInformativaToolb (AMessagem: string);
  function NomeMes(MesNomerico: integer): string;
  function FormateReal(AValorEntrada: string): string;

end;
  var
    frmPrincipal: TfrmPrincipal;
    Dm : TDm;

implementation

{$R *.fmx}
uses
  uLogin,uControleDeTela,uDmProcedures,uCadLancamento;


procedure TfrmPrincipal.FormShow(Sender: TObject);
begin
  Dm := TDm.Create(self);

  uControleDeTela.RecebTabPrincipal(tabPrinc_Home);

  if uDmProcedures.ExistUsuarioLogado then
    uControleDeTela.AvancaTela(tabPrinc_Home)
  else
    uControleDeTela.AvancaTela(tabPrinc_Login);
end;

procedure TfrmPrincipal.SairTelaCategoriaCadLancamento;
begin
  if cboxCategriaCadLanc.ItemIndex < 0 then
    vEdtCategCadLanc := ''
  else
    vEdtCategCadLanc := cboxCategriaCadLanc.Items[cboxCategriaCadLanc.ItemIndex];

  ValidaCampoCadLanc;
  tabcPrinc.Tabs[1]
end;

procedure TfrmPrincipal.SairTelaDataCadLancamento;
begin
  vEdtDataCadLanc     := DataSqlLite(edtDataCadLancamernto.Date);
  ValidaCampoCadLanc;
end;

procedure TfrmPrincipal.SairTelaDescricaoCadLancamento;
begin
  vEdtDescCadLanc     := UpperCase(edtDescricaoCadLanc.Text);
  ValidaCampoCadLanc;
end;

procedure TfrmPrincipal.SairTelaNroParcelaCadLancamento;
begin
  vEdtNroParCadLanc   := ctbNroPracela.Text;
  ValidaCampoCadLanc;

end;

procedure TfrmPrincipal.SairTelaQuitadoCadLancamento;
var
  indexCbox : string;
begin
  indexCbox := cboxQuitada.Items[cboxQuitada.ItemIndex];

  //vEdtQuitaCadLanc :=  ifelseConvert(indexCbox,'SIM','S','NAO','N');
  ValidaCampoCadLanc;
end;

procedure TfrmPrincipal.SairTelaValorCadLancamento;
begin
  vEdtVlrCadLanc       := edtValorCadLanc.Text;
  ValidaCampoCadLanc;
end;


{
procedure TfrmPrincipal.btnSalvarCadLancaentoClick(Sender: TObject);
begin

  ValidaCampoCadLanc;

  if vValidaCampoCadLanc then
  begin
    //SalvaCadLancamento;
    //IrParaTela(uAvancaTela.VoltaTela);
  end
  else
    exit
end;}

procedure TfrmPrincipal.btnSalvarCadLancamentoClick(Sender: TObject);
begin
  SairTelaCategoriaCadLancamento;
  actCadLanc_inicio.ExecuteTarget(self);
end;
 {
procedure TfrmPrincipal.CarregaCamposLancamento(LstVeiw: TListView; indexLst: integer);
begin
begin
  dm.FDQTabLancamento.Close;
  dm.FDQTabLancamento.Open();
  dm.FDQTabLancamento.Locate('id_lancamento', LstVeiw.Items[indexLst].Detail);
  dm.FDQTabLancamento.Edit;

  vEdtDescCadLanc   := dm.FDQTabLancamento.FieldByName('descricao').AsString;
  vEdtVlrCadLanc    := dm.FDQTabLancamento.FieldByName('valor').AsString;
  vEdtDataCadLanc   := dm.FDQTabLancamento.FieldByName('data').AsString;
  vEdtNroParCadLanc := dm.FDQTabLancamento.FieldByName('NROPARCELA').AsString;
  vEdtQuitaCadLanc  := dm.FDQTabLancamento.FieldByName('quitada').AsString;
  vEdtCategCadLanc  := dm.FDQTabLancamento.FieldByName('id_categoria').AsString;
end;
  }



{procedure TfrmPrincipal.IrParaTela(NomeTabi: TTabItem);
begin

  case NomeTabi.Index of
    0: //Login
    begin
      MultiView.Enabled := false;
      UsuarioCadastro;
      actPrinc_Login.ExecuteTarget(self);

    end;

    1: //Home
    begin
      MultiView.Enabled := true;
      //uTelaHome.IniciatabHome;
      //AtualTabiHome;

      actPrinc_Home.ExecuteTarget(self);
    end;

    2: //Lancamento
    begin
      vMes := MonthOf(now);
      vAno := YearOf(now);

      AtualLstLacanmentoTabiLancamento;

      actPrinc_Lancamento.ExecuteTarget(self);
    end;

    3: //Categorias
    begin
      AtualLstCategoriaTabiCategoria;
      actPrinc_Categoria.ExecuteTarget(self);

    end;

    4: //Cadastro de categoria
    begin

      if EdtCadCategoriaDesc.Text = '' then
        BtnCadCategoriaExclui.Visible := false
      else
        BtnCadCategoriaExclui.Visible := true;

      if vModuloCadCategoria = dsInsert then
      EdtCadCategoriaDesc.Text := '';

      EdtCadCategoriaDesc.SetFocus;
      actPrinc_CadCategoria.ExecuteTarget(self);
    end;

    5: //Perfil
    begin
      actPrinc_Perfil.ExecuteTarget(self);
    end;

    7: //Cadastro de Lancamento
    begin
      tabcCadLanc.ActiveTab    := tabCadLanc_Hone;

      AtualLstCadLancamento;
      AtualCboxCategoriaCadLancamento;
      AtualCboxQuitadoCadLancamento;

      actPrinc_CadLancamento.ExecuteTarget(self);
    end;
  end;
end;  }


procedure TfrmPrincipal.lblLoginCriaNovaContaClick(Sender: TObject);
begin
  uLogin.IniciarCadastroUsuario;
end;

 {
procedure TfrmPrincipal.AtualLstContaAbertaTabiHome;
var
  AddList: TListViewItem;
  TmultiDetail: TMultiDetailAppearanceNames;

  function TipoDebCred: string;
  begin
    if RectLinhaBtnAreceber.Fill.Color = $FF125C8E then
      result := 'C';

    if RectLinhaBtnApagar.Fill.Color = $FF125C8E then
      result := 'D';
  end;

  function TipoFiltroAtivo: string;
  begin
    if RectLinhaBtnAnterior.Fill.Color = $FF125C8E then
      result := ' < '
    else if RectLinhaBtnHoje.Fill.Color = $FF125C8E then
      result := ' = '
    else
      result := ' > '
  end;

begin
  with Dm.FDQListaApagarAreceber do
  begin
    Close;
    SQL.strings[7] := '';
    SQL.strings[8] := '';
    SQL.strings[7] := ' and tipo_lancamento like :tipoLancamento';
    SQL.strings[8] := ' and data' + TipoFiltroAtivo + ':data';

    ParamByName('tipoLancamento').Value := TipoDebCred;
    ParamByName('DATA').Value := DataSqlLite(now());
    Open();
    first;

    LstContasAberta.Items.Clear;
    LstContasAberta.BeginUpdate;

    while not eof do
    begin

      AddList         := LstContasAberta.Items.Add;
      AddList.Detail  := FieldByName('id').AsString;
      AddList.Text    := FieldByName('descricao').AsString;
      AddList.Data[TmultiDetail.Detail1] := FormateReal(FieldByName('valor').AsString);
      AddList.Data[TmultiDetail.Detail2] := FieldByName('data').AsString;


    end;

    LstContasAberta.EndUpdate;
  end;
end;    }
{
procedure TfrmPrincipal.AtualLstLacanmentoTabiLancamento;
var
  TitemAdd: TListViewItem;
  TmultiDetail: TMultiDetailAppearanceNames;
  Icone: Integer;
  IdLancamento, Descricao, Valor, Categoria: string;
begin

  Dm.FDQlancamento.Close;
  Dm.FDQlancamento.ParamByName('MES').Value := FormatFloat('00', vMes);
  Dm.FDQlancamento.ParamByName('ANO').Value := FormatFloat('00', vAno);
  Dm.FDQlancamento.Open;
  Dm.FDQlancamento.first;

  LstLancamento.Items.Clear;
  LstLancamento.BeginUpdate;
  while not Dm.FDQlancamento.eof do
  begin
    IdLancamento  := Dm.FDQlancamento.FieldByName('id_lancamento').AsString;
    Descricao     := Dm.FDQlancamento.FieldByName('descricao').AsString;
    Valor         := Dm.FDQlancamento.FieldByName('valor').AsString;
    Categoria     := Dm.FDQlancamento.FieldByName('categoria').AsString;
    Icone         := Dm.FDQlancamento.FieldByName('icone').AsInteger;

    TitemAdd := LstLancamento.Items.Add;
    TitemAdd.Detail := IdLancamento;
    TitemAdd.ImageIndex := Icone;
    TitemAdd.Text := Descricao;
    TitemAdd.Data[TmultiDetail.Detail1] := FormateReal(Valor);
    TitemAdd.Data[TmultiDetail.Detail2] := Categoria;
    Dm.FDQlancamento.Next;
  end;

  LstLancamento.EndUpdate;

  Dm.FDQlancamento.Close;
  Dm.FDQgeral.Close;
  Dm.FDQgeral.SQL.Clear;
  Dm.FDQgeral.SQL.Add
    ('select sum(case when tipo_lancamento = ''D'' then valor else 0 end) despesas,');
  Dm.FDQgeral.SQL.Add
    ('       sum(case when tipo_lancamento = ''C'' then valor else 0 end) receitas');
  Dm.FDQgeral.SQL.Add('from tab_lancamento');
  Dm.FDQgeral.SQL.Add('where strftime(''%m'', data) = :pMes');
  Dm.FDQgeral.SQL.Add('and strftime(''%Y'', data)   = :pAno');
  Dm.FDQgeral.ParamByName('pMes').Value := FormatFloat('00', vMes);
  Dm.FDQgeral.ParamByName('pAno').Value := FormatFloat('00', vAno);
  Dm.FDQgeral.Open;

  lblTotalReceita.Text := FormateReal(Dm.FDQgeral.FieldByName('receitas').AsString);
  lblTotalDespesa.Text := FormateReal(Dm.FDQgeral.FieldByName('despesas').AsString);
  lblData.Text := NomeMes(vMes) + ' / ' + IntToStr(vAno);
  Dm.FDQgeral.Close;

end;      }


{
procedure TfrmPrincipal.AtualLstCategoriaTabiCategoria;
var
  itemAdd: TListViewItem;
begin

  Dm.FDQcategoria.SQL.Clear;
  Dm.FDQcategoria.SQL.Add('select id_categoria, descricao');
  Dm.FDQcategoria.SQL.Add('from tab_categoria order by descricao');
  Dm.FDQcategoria.Open;
  Dm.FDQcategoria.first;

  ListCategoria.Items.Clear;
  ListCategoria.BeginUpdate;

  while not Dm.FDQcategoria.eof do
  begin

    itemAdd         := ListCategoria.Items.Add;
    itemAdd.Detail  := Dm.FDQcategoria.FieldByName('id_categoria').AsString;
    itemAdd.Text    := Dm.FDQcategoria.FieldByName('descricao').AsString;

    Dm.FDQcategoria.Next;
  end;

  ListCategoria.EndUpdate;
  Dm.FDQcategoria.Close;

end;
     }
procedure TfrmPrincipal.ListBoxLancamentoClick(Sender: TObject);
begin
  MultiView.HideMaster;
  //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_Lancamento));
end;

procedure TfrmPrincipal.listBoxPaineClick(Sender: TObject);
begin
  MultiView.HideMaster;
  //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_Home));
end;

procedure TfrmPrincipal.ListBoxPerfilClick(Sender: TObject);
begin
  MultiView.HideMaster;
  AvancaTela(TabPrinc_Perfil);
end;

procedure TfrmPrincipal.ListBoxCategoriaClick(Sender: TObject);
begin
  MultiView.HideMaster;
  //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_Categoria));
end;

procedure TfrmPrincipal.ListCategoriaItemClickEx(const Sender: TObject;
ItemIndex: Integer; const LocalClickPos: TPointF;
const ItemObject: TListItemDrawable);
begin

  BtnCadCategoriaExclui.Visible := true;
  EdtCadCategoriaDesc.Text      := ListCategoria.Items[ItemIndex].Text;
  vIdCategoriaEditar            := ListCategoria.Items[ItemIndex].Detail;

  //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_CadCategoria));
end;

procedure TfrmPrincipal.lstCadLancamentoItemClickEx(const Sender: TObject;
  ItemIndex: Integer; const LocalClickPos: TPointF;
  const ItemObject: TListItemDrawable);
begin
  ClickLstCadLancamento(ItemIndex);
end;


 {
procedure TfrmPrincipal.lstCadLancamento_oldItemClickEx(const Sender: TObject;
  ItemIndex: Integer; const LocalClickPos: TPointF;
  const ItemObject: TListItemDrawable);
begin

  case ItemIndex of
  0:
    begin
      edtDescricaoCadLanc.Text := vEdtDescCadLanc;
      actCadLanc_Descricao.ExecuteTarget(self);
    end;
  1:
    begin
      edtValorCadLanc.Text := vEdtVlrCadLanc;
      //actTabiValor.ExecuteTarget(self);
    end;
  2:
    begin
      edtDataCadLancamernto.Text := vEdtDataCadLanc;
      //ctTabiData.ExecuteTarget(self);
    end;
  3:
    begin
      ctbNroPracela.Text := vEdtNroParCadLanc;
      //actTabiNroParcela.ExecuteTarget(self);
    end;
  4:
    begin
      //cboxQuitada.ItemIndex := StrToInt(ifelseConvert(vEdtQuitaCadLanc,'S','0','N','1'));
      //actTabiQuitada.ExecuteTarget(self);
    end;
  5:
    begin

      //actTabiCategoria.ExecuteTarget(self);
    end;
  end;

  //btnSalvarCadLancaento.Enabled := true;
end;      }

procedure TfrmPrincipal.AlteracaodimensaoDaTela;
var
  larg_tela : integer;
begin
  {$IFDEF ANDROID}
  larg_tela := Screen.Width;
  {$ENDIF}

  {$IFDEF MSEINDOWS}
  larg_tela := frmPrincipal.Width;
  {$ENDIF}

end;
 {
procedure TfrmPrincipal.AtualCboxCategoriaCadLancamento;
var
  i: integer;
  a: Integer;

begin
  i := 0;
  for a := 0 to High(vIDcbxCategoria) do
    vIDcbxCategoria[a] := 0;

  cboxCategriaCadLanc.Items.Clear;

  dm.FDQcategoria.Close;
  dm.FDQcategoria.Open();
  while not dm.FDQcategoria.Eof  do
  begin

    cboxCategriaCadLanc.Items.add(dm.FDQcategoria.FieldByName('descricao').AsString);
    vIDcbxCategoria[i] := dm.FDQcategoria.FieldByName('id_categoria').AsInteger;
    i := i+ 1;
    dm.FDQcategoria.Next;

  end;

  dm.FDQcategoria.Close;
end;   }

procedure TfrmPrincipal.AtualCboxQuitadoCadLancamento;
begin
  cboxQuitada.Items.Clear;
  cboxQuitada.Items.Add('SIM');
  cboxQuitada.Items.Add('NAO');

  cboxQuitada.Index := -1;
end;


{procedure TfrmPrincipal.LstContasAbertaItemClickEx(const Sender: TObject;
  ItemIndex: Integer; const LocalClickPos: TPointF;
  const ItemObject: TListItemDrawable);
begin
  EnviaLancamentoParaEdicao(LstContasAberta, ItemIndex);
end;}

procedure TfrmPrincipal.LstLancamentoItemClickEx(const Sender: TObject;
ItemIndex: Integer; const LocalClickPos: TPointF;
const ItemObject: TListItemDrawable);
begin
  EnviaLancamentoParaEdicao(LstLancamento, ItemIndex);
end;

  {

  var
  idCategoria, Valor: string;
  with Dm do
  begin

    FDQlancamento.Open;
    FDQlancamento.Locate('id_lancamento',LstLancamento.Items[ItemIndex].Detail);
    FDQlancamento.Edit;

    FDQSelectConsulta.Close;
    FDQSelectConsulta.SQL.Clear;
    FDQSelectConsulta.SQL.Add
      ('select id_categoria from  tab_lancamento where id_lancamento = :id');
    FDQSelectConsulta.ParamByName('id').Value := LstLancamento.Items[ItemIndex].Detail;
    FDQSelectConsulta.Open();

  end;

  idCategoria := Dm.FDQSelectConsulta.FieldByName('id_categoria').AsString;
  Valor       := LstLancamento.Items[ItemIndex].Data[TMultiDetailAppearanceNames.Detail1].AsString;

  // EdtCadLancaValor.Text         := StringReplace(valor, 'R$','',[rfReplaceAll]);
  // EdtCadLancaDescricao.Text     := ListLancamento.Items[ItemIndex].Text;
  // CbxCadLancCategoria.ItemIndex := IndexText(idCategoria,vIDcbxCategoria);

  Dm.FDQSelectConsulta.Close; }


procedure TfrmPrincipal.MsgInformativaToolb(AMessagem: string);
begin
  toobInformativa.Visible     := true;
  LblTbrInformacao.Text       := AMessagem;
  TimFechaInformacao.Enabled  := true;
end;

function TfrmPrincipal.NomeMes(MesNomerico: integer): string;
begin
  case MesNomerico of
    1:
      result := 'Janeiro';
    2:
      result := 'Fevereiro';
    3:
      result := 'Macço';
    4:
      result := 'Abril';
    5:
      result := 'Maio';
    6:
      result := 'Julho';
    7:
      result := 'Junho';
    8:
      result := 'Agosto';
    9:
      result := 'Setembro';
    10:
      result := 'Outubro';
    11:
      result := 'Novembro';
    12:
      result := 'Dezembro';
  end;
end;


procedure TfrmPrincipal.rectNovaDespesaClick(Sender: TObject);
begin
  NovoLancamento('despesa');
end;

procedure TfrmPrincipal.rectNovaReceitaClick(Sender: TObject);
begin
  NovoLancamento('receita');
end;

procedure TfrmPrincipal.SpeedButton10Click(Sender: TObject);
begin

  //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_CadCategoria));

end;

procedure TfrmPrincipal.SpeedButton1Click(Sender: TObject);
begin

  case tabcCadLanc.TabIndex of
    0: uControleDeTela.VoltaTela;
    1:
    begin
      actCadLanc_Novo.ExecuteTarget(self);
    end;
  end;




{          SairTelaDescricaoCadLancamento;
    2:
    begin
      SairTelaValorCadLancamento;
      actTabiDescricao.ExecuteTarget(self);
    end;

    3:
    begin
      SairTelaDataCadLancamento;
      actTabiValor.ExecuteTarget(self);
    end;

    4:
    begin
      SairTelaNroParcelaCadLancamento;
      actTabiData.ExecuteTarget(self);
    end;
    5:
    begin
      SairTelaQuitadoCadLancamento;
      actTabiNroParcela.ExecuteTarget(self);
    end;
    6:
    begin
      SairTelaCategoriaCadLancamento;
      actTabiQuitada.ExecuteTarget(self);
    end;
  end;   }
end;

procedure TfrmPrincipal.SpeedButton2Click(Sender: TObject);
begin
  EdtLoginSenha.Text := '';
  actLogin_Logar.ExecuteTarget(self);
end;

procedure TfrmPrincipal.SpeedButton3Click(Sender: TObject);
begin
  SairTelaDescricaoCadLancamento;
  //actTabi00.ExecuteTarget(self);
end;

procedure TfrmPrincipal.SpeedButton4Click(Sender: TObject);
begin
  SairTelaValorCadLancamento;
  //actTabi00.ExecuteTarget(self);
end;

procedure TfrmPrincipal.SpeedButton5Click(Sender: TObject);
begin
  SairTelaDataCadLancamento;
  //actTabi00.ExecuteTarget(self);
end;

procedure TfrmPrincipal.SpeedButton6Click(Sender: TObject);
begin
  SairTelaNroParcelaCadLancamento;
  //actTabi00.ExecuteTarget(self);
end;

procedure TfrmPrincipal.SpeedButton7Click(Sender: TObject);
begin
  SairTelaQuitadoCadLancamento;
  //actTabi00.ExecuteTarget(self);
end;

procedure TfrmPrincipal.SpeedButton8Click(Sender: TObject);
begin
  SairTelaCategoriaCadLancamento;
  //actTabi00.ExecuteTarget(self);
end;
{
procedure TfrmPrincipal.SalvaCadLancamento;
var
  idCadlancamento: integer;

begin
  if vModulo = dsInsert then
  begin
    //idCadlancamento     := GeraNovoIdTabela('tab_lancamento','id_lancamento');
    dm.FDQtabLancamento.Open();
    dm.FDQtabLancamento.Insert;
  end;

  with dm.FDQtabLancamento do
  begin

    FieldByName('descricao').AsString         := UpperCase(vEdtDescCadLanc);
    FieldByName('valor').AsString             := vEdtVlrCadLanc;
    FieldByName('data').AsString              := vEdtDataCadLanc;
    FieldByName('nroparcela').AsString        := vEdtNroParCadLanc;
    FieldByName('quitada').AsString           := vEdtQuitaCadLanc;
    FieldByName('id_categoria').AsInteger     := vIDcbxCategoria[cboxCategriaCadLanc.ItemIndex];
    FieldByName('tipo_lancamento').AsString   := vTipoLancameto;

    if state in [dsEdit] then
      post
    else
    begin
      FieldByName('id_lancamento').AsInteger := idCadlancamento;
      post
    end;

    Close;
  end;

  MsgInformativaToolb('Lancamento salvo !');
end;
       }
procedure TfrmPrincipal.ValidaCampoCadLanc;
begin
  vValidaCampoCadLanc := false;

  if (vEdtDescCadLanc = '') then
    vDetal2DescLstCadLanca := 'Campo Obrigatorio'
  else
  begin
    vDetal2DescLstCadLanca := '';
    if (vEdtVlrCadLanc = '') then
      vDetal2LstCadLancaVlr := 'Campo Obrigatorio'
    else
      begin
        vDetal2LstCadLancaVlr := '';
        if (vEdtDataCadLanc = '') then
          vDetal2LstCadLancaDate := 'Campo Obrigatorio'
        else
        begin
          vDetal2LstCadLancaDate := '';
          if (vEdtNroParCadLanc = '')  then
            vDetal2LstCadLancaNroPar := 'Campo Obrigatorio'
          else
          begin
            vDetal2LstCadLancaNroPar := '';
            if (vEdtQuitaCadLanc = '') then
              vDetal2LstCadLancaQuita := 'Campo Obrigatorio'
            else
            begin
              vDetal2LstCadLancaQuita := '';
              if (vEdtCategCadLanc = '') then
                vDetal2LstCadLancaCateg := 'Campo Obrigatorio'
              else
              begin
                vDetal2LstCadLancaCateg := '';
                //btnSalvarCadLancaento.Visible := true;
                vValidaCampoCadLanc := true;
              end;
            end;
          end;
        end;
      end;
  end;


end;


{
function TfrmPrincipal.ValidaSenhaUsuario: boolean;
begin
  if (EdtLoginSenha.Text) = ''then
    begin
      Dm.FDQuery1.Edit;
      Dm.FDQuery1.FieldByName('ind_login').AsString := 'S';
      Dm.FDQuery1.Post;
      result := true;
    end
    else
    begin
      MsgInformativaToolb('Usuário ou senha invalida.');
      result := false;
    end;
end;     }

procedure TfrmPrincipal.BtnLancExcluirClick(Sender: TObject);
begin
  //Dm.FDQlancamento.Delete;
end;

procedure TfrmPrincipal.BtnPerfilLogoffClick(Sender: TObject);
begin
  uDmProcedures.UpdateUsuarioCadastrado('N');
  uControleDeTela.AvancaTela(tabPrinc_Login);
end;

procedure TfrmPrincipal.BtnPerfilVoltaClick(Sender: TObject);
begin
  uControleDeTela.VoltaTela;
end;

procedure TfrmPrincipal.BtnHomeVoltaMesClick(Sender: TObject);
begin

  vMes := vMes - 1;
  if vMes = 0 then
  begin
    vMes := 12;
    vAno := vAno - 1;
  end;

  //AtualTabiHome;

end;

procedure TfrmPrincipal.lblBtnContasAreceberClick(Sender: TObject);
begin
  //EfeitoBtnApagarReceber(RectLinhaBtnAreceber);
  //AtualLstContaAbertaTabiHome;
end;

procedure TfrmPrincipal.BtnHabilitaFiltroHomeClick(Sender: TObject);
begin

  {if BtnHabilitaFiltroHome.StyleLookup = 'spinbottombutton' then
  begin
    FiltrolstContaAberta('sim');
  end
  else
  begin
    FiltrolstContaAberta('nao');
  end;}

end;

procedure TfrmPrincipal.BtnHomeAvancaMesClick(Sender: TObject);
begin
  vMes := vMes + 1;
  if vMes > 12 then
  begin
    vMes := 1;
    vAno := vAno + 1;
  end;
  //AtualTabiHome;
end;

procedure TfrmPrincipal.BtnHomeHomeClick(Sender: TObject);
begin
  //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_Home));
end;

procedure TfrmPrincipal.BtnHomeLancDespesaClick(Sender: TObject);
begin

  IniciaNovoLancamento('despesa');
  //IrParaTela(uAvancaTela.AvancaTela(TabPrinc_CadLancamento));

end;

procedure TfrmPrincipal.BtnHomeLancReceitaClick(Sender: TObject);
begin
  IniciaNovoLancamento('receita');
  //IrParaTela(uAvancaTela.AvancaTela(TabPrinc_CadLancamento));
end;

procedure TfrmPrincipal.BtnHomeNotificacaoClick(Sender: TObject);
begin
  //uAvancaTela.AvancaTela('tela','tela2');
end;

procedure TfrmPrincipal.BtnCadLancamentoVoltaClick(Sender: TObject);
begin
  //Dm.FDQlancamento.Cancel;
  //Dm.FDQlancamento.Close;
end;

procedure TfrmPrincipal.lblBtnContasApagarClick(Sender: TObject);
begin

//  EfeitoBtnApagarReceber(RectLinhaBtnApagar);
  //AtualLstLacanmentoTabiLancamento;

end;

procedure TfrmPrincipal.lblBtnProxinoClick(Sender: TObject);
begin

  vTipoFiltro := 'proxino';
//  EfeitoBtnFiltro(RectLinhaBtnProxino);
  //AtualLstContaAbertaTabiHome;
  FiltrolstContaAberta('nao');

end;

procedure TfrmPrincipal.lblBtnAnteriorClick(Sender: TObject);
begin

  vTipoFiltro := 'anterior';
//  EfeitoBtnFiltro(RectLinhaBtnAnterior);
  //AtualLstLacanmentoTabiLancamento;
  FiltrolstContaAberta('nao');

end;




procedure TfrmPrincipal.lblBtnHojeClick(Sender: TObject);
begin

  vTipoFiltro := 'hoje';
//  EfeitoBtnFiltro(RectLinhaBtnHoje);
  //AtualLstLacanmentoTabiLancamento;
  FiltrolstContaAberta('nao');

end;

procedure TfrmPrincipal.TimFechaInformacaoTimer(Sender: TObject);
begin
  toobInformativa.Visible := false;
  TimFechaInformacao.Enabled := false;
end;




{procedure TfrmPrincipal.UsuarioCadastro;
begin
  dm.FDQuery1.Close;
  dm.FDQuery1.Open();

  if dm.FDQuery1.RecordCount = 0 then
    CadastrarUsuario
  else
    begin
      TabcLogin.ActiveTab   := tabLogin_Logar;
      lblUsuarioLogin.Text := dm.FDQuery1.FieldByName('login').AsString;
    end;

  dm.FDQuery1.Close;
  EdtLoginSenha.Text := '';
end;  }

procedure TfrmPrincipal.BtnLancamentoVoltaClick(Sender: TObject);
begin
   //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_Home));
end;

procedure TfrmPrincipal.BtnLancamentoVoltaMesClick(Sender: TObject);
begin
  vMes := vMes - 1;
  if vMes = 0 then
  begin
    vMes := 12;
    vAno := vAno - 1;
  end;
  //AtualLstLacanmentoTabiLancamento;
end;

procedure TfrmPrincipal.BtnLancamentoAddClick(Sender: TObject);
begin
  fgActNovoLanca.Show;
end;

procedure TfrmPrincipal.BtnLancamentoAvancaMesClick(Sender: TObject);
begin
  vMes := vMes + 1;
  if vMes > 12 then
  begin
    vMes := 1;
    vAno := vAno + 1;
  end;
  //AtualLstLacanmentoTabiLancamento;
end;
  {
function TfrmPrincipal.GeraNovoIdTabela(ATabela, ACampoChave: string): Integer;
begin

  dm.FDQNovoID.First vai para primeira linha;
  dm.FDQNovoID.Last vai para ultima linha;
  dm.FDQNovoID.Next vai para proxima linha;
}
  {
  Dm.FDQNovoID.SQL.Clear;
  Dm.FDQNovoID.SQL.Add('select COALESCE(max(' + ACampoChave +
    '),0) codigo from ' + ATabela);
  Dm.FDQNovoID.Open;

  result := Dm.FDQNovoID.FieldByName('codigo').AsInteger + 1;
  Dm.FDQNovoID.Close;

end;         }

procedure TfrmPrincipal.LimpavDetal2LstCadLanc;
begin

  vDetal2DescLstCadLanca   := '';
  vDetal2LstCadLancaVlr    := '';
  vDetal2LstCadLancaDate   := '';
  vDetal2LstCadLancaNroPar := '';
  vDetal2LstCadLancaQuita  := '';
  vDetal2LstCadLancaCateg  := '';

end;


procedure TfrmPrincipal.Image9Click(Sender: TObject);
begin
  AvancaTela(TabPrinc_CadLancamento);
end;

procedure TfrmPrincipal.IniciaNovoLancamento(DC: string);

begin
  if DC = 'despesa' then
  begin
    vTipoLancameto            := 'D';
    lblTituloCadLancamento.Text := 'Lancamento de despesa';
  end
  else
  begin
    vTipoLancameto            := 'C';
    lblTituloCadLancamento.Text := 'Lancamento de receita';
  end;

  edtDescricaoCadLanc.Text    := '';
  edtValorCadLanc.Text        := '';
  edtDataCadLancamernto.Date  := now;
  ctbNroPracela.Value         := 1;
  cboxQuitada.Index           := -1;
  cboxCategriaCadLanc.Index   := -1;

  vEdtDescCadLanc             := '';
  vEdtVlrCadLanc              := '';
  vEdtDataCadLanc             := '';
  vEdtNroParCadLanc           := '';
  vEdtQuitaCadLanc            := '';
  vEdtCategCadLanc            := '';

  BtnCadCategoriaExclui.Visible  := false;
  LimpavDetal2LstCadLanc;

  vModulo := dsInsert;
end;

procedure TfrmPrincipal.FiltrolstContaAberta(status: string);
begin

  if status = 'sim' then
  begin

    //Layout11.Height  := 115;
    //Layout13.Visible := true;
    //BtnHabilitaFiltroHome.StyleLookup := 'spintopbutton';

  end
  else
  begin

    //Layout11.Height  := 75;
    //Layout13.Visible := false;
    //BtnHabilitaFiltroHome.StyleLookup := 'spinbottombutton';

  end;

end;

function TfrmPrincipal.FormateReal(AValorEntrada: string): string;
begin
  if pos(',', AValorEntrada) > 0 then
    AValorEntrada := StringReplace(AValorEntrada, ',', '', [rfReplaceAll])
  else if pos('.', AValorEntrada) > 0 then
    AValorEntrada := StringReplace(AValorEntrada, '.', '', [rfReplaceAll])
  else
    AValorEntrada := AValorEntrada + '00';

  result := FormatFloat('###0.00', StrToFloat(AValorEntrada) / 100);
end;

procedure TfrmPrincipal.FormCloseQuery(Sender: TObject; var CanClose: Boolean);
begin
  Application.Terminate;
end;

procedure TfrmPrincipal.FormCreate(Sender: TObject);
begin

  LstLancamento.ItemAppearanceObjects.ItemObjects.Image.Visible := true;

  LstLancamento.ItemAppearance.ItemEditAppearance   :=  'MultiDetailItemShowCheck';
  //LstContasAberta.ItemAppearance.ItemEditAppearance := 'MultiDetailItemShowCheck';

  tabcCadLanc.TabPosition  := TTabPosition.None;
  tabcPrinc.TabPosition    := TTabPosition.None;
  TabcLogin.TabPosition    := TTabPosition.None;
  tabcPrinc.ActiveTab      := tabPrinc_Login;

  toobInformativa.Visible := false;
  MultiView.Enabled       := false;

  imgUltimoLancDespesa.Visible  := False;
  imgUltimoLancReceita.Visible  := False;
  ImgCadLancInterogacao.Visible := False;
end;

procedure TfrmPrincipal.FormKeyUp(Sender: TObject; var Key: Word;
var KeyChar: Char; Shift: TShiftState);
{$IFDEF ANDROID}
var
  Fservice: IFMXVirtualKeyboardService;
{$ENDIF}
begin
{$IFDEF ANDROID}
  if (Key = vkHardwareBack) then
  begin
    TPlatformServices.Current.SupportsPlatformService
      (IFMXVirtualKeyboardService, IInterface(Fservice));

    if (Fservice <> nil) and (TVirtualKeyboardState.Visible
      in Fservice.VirtualKeyBoardState) then
    begin
    end
    else if tabcPrinc.ActiveTab = tabPrinc_Home then
    begin
    end;
    if tabcPrinc.ActiveTab = tabPrinc_CadCategoria then
    begin
      Key := 0;
      // TelaAnterio;
    end;
  end
{$ENDIF}
end;

procedure TfrmPrincipal.FormResize(Sender: TObject);
begin
  AlteracaodimensaoDaTela();
end;

function TfrmPrincipal.DataSqlLite(Adata: TDateTime): string;
begin
  result := FormatDateTime('dd/mm/yyyy', Adata);
end;


procedure TfrmPrincipal.EdtCadCategoriaDescExit(Sender: TObject);
begin
  EdtCadCategoriaDesc.Text := UpperCase(EdtCadCategoriaDesc.Text);
end;

{
  procedure TfrmPrincipal.EdtCadLancaDescricaoExit(Sender: TObject);
  begin
  EdtCadLancaDescricao.Text := UpperCase(EdtCadLancaDescricao.Text);
  end;
  procedure TfrmPrincipal.EdtCadLancaDescricaoKeyUp(Sender: TObject;
  var Key: Word; var KeyChar: Char; Shift: TShiftState);
  begin
  EdtCadLancaDescricao.Text := UpperCase(EdtCadLancaDescricao.Text)
  end;

  procedure TfrmPrincipal.EdtCadLancaValorExit(Sender: TObject);
  var
  conversao : string;
  begin
  if pos(',',EdtCadLancaValor.Text) > 0 then
  conversao := StringReplace(EdtCadLancaValor.Text,',','',[rfReplaceAll])
  else
  conversao := EdtCadLancaValor.Text+'00';
  EdtCadLancaValor.Text := FormatFloat('###0.00', StrToFloat(conversao)/100);
  end;
}

procedure TfrmPrincipal.EdtCadLancaValorKeyDown(Sender: TObject; var Key: Word;
var KeyChar: Char; Shift: TShiftState);
begin
  if not(KeyChar in ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0', ','])
  then
    KeyChar := #0;
end;

procedure TfrmPrincipal.edtCadLoginConfiSenhaExit(Sender: TObject);
begin
  if edtCadLoginConfiSenha.Text <> edtCadLoginSenha.text then
    MsgInformativaToolb('Senha nao conferi com a digitada');
end;

procedure TfrmPrincipal.EdtCadLoginNoneExit(Sender: TObject);
begin
  if EdtCadLoginNone.Text = '' then
    MsgInformativaToolb('Informe o nome do usuario');
end;

procedure TfrmPrincipal.edtCadLoginSenhaExit(Sender: TObject);
begin
  if edtCadLoginSenha.Text = '' then
    MsgInformativaToolb('Infrome a senha');
end;

procedure TfrmPrincipal.edtCadLancDescricaoExit(Sender: TObject);
begin
  edtDescricaoCadLanc.Text := UpperCase(edtDescricaoCadLanc.Text)
end;

procedure TfrmPrincipal.edtCadLancValorKeyDown(Sender: TObject; var Key: Word;
  var KeyChar: Char; Shift: TShiftState);
begin
If not(keychar in['0'..'9',',',#08]) then
  KeyChar:=#0;
end;

procedure TfrmPrincipal.EfeitoBtnApagarReceber(Botao: TRectangle);
begin

  //RectLinhaBtnAreceber.Fill.Color := $0000;
  //RectLinhaBtnApagar.Fill.Color := $0000;

  Botao.Fill.Color := $FF125C8E;

end;

procedure TfrmPrincipal.EfeitoBtnFiltro(Botaofiltro: TRectangle);
begin

  //RectLinhaBtnAnterior.Fill.Color := $0000;
  //RectLinhaBtnHoje.Fill.Color := $0000;
  //RectLinhaBtnProxino.Fill.Color := $0000;

  Botaofiltro.Fill.Color := $FF125C8E

end;

procedure TfrmPrincipal.EnviaLancamentoParaEdicao(LstView1: TListView; indexLst: integer);
begin
  LimpavDetal2LstCadLanc;
  CarregaCamposLancamento(LstView1,indexLst);
  //IrParaTela(uAvancaTela.AvancaTela(TabPrinc_CadLancamento));
end;

{procedure TfrmPrincipal.AtualTabiHome;
  procedure AtualizaLblSaldoAtual;
  var
    Totalpago, Totalrecebido, SaldoAtual: Double;

  begin
    with Dm.FDQSaldo do
    begin
      Close;
      ParamByName('quitada').Value := 'S';
      ParamByName('tipo').Value := 'D';
      Open();
      Totalpago := FieldByName('saldo').AsFloat;
      Close;

      ParamByName('quitada').Value := 'S';
      ParamByName('tipo').Value := 'C';
      Open();
      Totalrecebido := FieldByName('saldo').AsFloat;
      Close;

      SaldoAtual := Totalrecebido - Totalpago;

      lblSaldoAtual.Text := FormateReal(FloatToStr(SaldoAtual));

      if SaldoAtual < 0 then
         lblSaldoAtual.FontColor := claRed
      else
         lblSaldoAtual.FontColor :=  claBlack;

    end;
  end;

  procedure AtualizaLblTotalApagar;
  begin
    with Dm.FDQSaldo do
    begin
      Close;
      ParamByName('quitada').Value := 'N';
      ParamByName('tipo').Value := 'D';
      Open();

      lblTotalApagar.Text := FormateReal(FieldByName('saldo').AsString);
      Close;
    end;
  end;

  procedure AtualizaLblTotalAreceber;
  begin
    with Dm.FDQSaldo do
    begin
      Close;
      ParamByName('quitada').Value := 'N';
      ParamByName('tipo').Value := 'C';
      Open();

      lblTotalAreceber.Text := FormateReal(FieldByName('saldo').AsString);
      Close;
    end;
  end;

  procedure AtualizalblNomeUsuario;
  begin
    with Dm.FDQuery1 do
    begin

      Close;
      Open();
      lblNomeDoUsuario.Text := 'Olá!' + FieldByName('login').AsString;
      Close

    end;
  end;
begin

  //AtualizalblNomeUsuario;

  //AtualizaLblSaldoAtual;

  AtualizaLblTotalApagar;
  AtualizaLblTotalAreceber;

  FiltrolstContaAberta('nao');

  EfeitoBtnFiltro(RectLinhaBtnHoje);
  EfeitoBtnApagarReceber(RectLinhaBtnApagar);

  AtualLstContaAbertaTabiHome;
end;
 }
procedure TfrmPrincipal.btnAcessarClick(Sender: TObject);
begin

   if uLogin.ValidaSenhaUsuario(EdtLoginSenha.Text) then
    begin
      uDmProcedures.UpdateUsuarioCadastrado('S');
      uControleDeTela.AvancaTela(tabPrinc_Home);
    end
    else
    begin
      MsgInformativaToolb('Informe a senha.');
      EdtLoginSenha.SetFocus;
    end;
end;

procedure TfrmPrincipal.btnAvancarDataClick(Sender: TObject);
begin
  SairTelaDataCadLancamento;
  //actTabiNroParcela.ExecuteTarget(self);
end;

procedure TfrmPrincipal.btnAvancarDescricaoClick(Sender: TObject);
begin
  SalvaDescricaoCadLancamento;
  edtCadLancValor.Text = '';
end;

procedure TfrmPrincipal.btnAvancarNroParcelaClick(Sender: TObject);
begin
  SairTelaNroParcelaCadLancamento;
  //actTabiQuitada.ExecuteTarget(self);
end;

procedure TfrmPrincipal.btnAvancarQuitadadoClick(Sender: TObject);
begin
  SairTelaQuitadoCadLancamento;
  //actTabiCategoria.ExecuteTarget(self);
end;

procedure TfrmPrincipal.btnAvancarValorClick(Sender: TObject);
begin
  SairTelaValorCadLancamento;
  //actTabiData.ExecuteTarget(self);
end;

procedure TfrmPrincipal.btnCadastarUsuarioClick(Sender: TObject);
begin
  uDmProcedures.InsertUsuario;
  EdtLoginSenha.text := '';
  EdtLoginSenha.SetFocus;
  uLogin.UsuarioCadastro;
  TabcLogin.ActiveTab := tabLogin_Logar;
end;

procedure TfrmPrincipal.BtnCategoriaAddClick(Sender: TObject);
begin

  EdtCadCategoriaDesc.Text := '';
  EdtCadCategoriaDesc.SetFocus;
  vModuloCadCategoria := dsInsert;
  //IrParaTela(uAvancaTela.AvancaTela(tabPrinc_CadCategoria));

end;

procedure TfrmPrincipal.BtnCategoriaVoltaClick(Sender: TObject);
begin
  //IrParaTela(uAvancaTela.VoltaTela);
  //AvancaTela(tabPrinc_Home);
end;
 {
procedure TfrmPrincipal.BtnCadCategoriaVoltaClick(Sender: TObject);
begin

  if Dm.FDQcategoria.State in dsEditModes then
    Dm.FDQcategoria.Cancel;

  //IrParaTela(uAvancaTela.VoltaTela);

end;}
{
procedure TfrmPrincipal.BtnCadCategoriaSalvaClick(Sender: TObject);

  function ValidaCampoCadCateoria: Boolean;
  begin
    result := false;
    
    if EdtCadCategoriaDesc.Text = '' then
    begin
      MsgInformativaToolb('Informe o nome da categoria.');
      EdtCadCategoriaDesc.SetFocus;
      result := true;
      exit
    end
    else
    begin 
      with dm.FDQcategoria do
      begin
        close;
        Open();
        while not eof do 
        begin
          if FieldByName('descricao').AsString = UpperCase(EdtCadCategoriaDesc.Text) then
          begin
            MsgInformativaToolb('Ja exite categoria catastrada com este nome');
            EdtCadCategoriaDesc.Text := '';
            EdtCadCategoriaDesc.SetFocus;
            result:= true;
            exit
          end
          else 
            next;
        end;
        close;
      end; 

    end;

  end;

  procedure GravaCadCategoria;
  begin

   Dm.FDQcategoria.Open(); 

   if vModulo = dsEdit then
   begin
    dm.FDQcategoria.Close;
    dm.FDQcategoria.Open();
    Dm.FDQcategoria.Locate('id_categoria', vIdCategoriaEditar);
    dm.FDQcategoria.Edit;
    Dm.FDQcategoriaDESCRICAO.AsString := UpperCase(EdtCadCategoriaDesc.Text);
    Dm.FDQcategoria.Post;
   end
   else
   begin 
    dm.FDQcategoria.Insert;
    Dm.FDQcategoriaDESCRICAO.AsString     := UpperCase(EdtCadCategoriaDesc.Text);
    //Dm.FDQcategoriaID_CATEGORIA.AsInteger := GeraNovoIdTabela('tab_categoria','id_categoria');
    Dm.FDQcategoria.Post;  
   end;

   Dm.FDQcategoria.Close;  
  end;

begin
  if ValidaCampoCadCateoria then
    exit
  else
  begin 
    GravaCadCategoria;
    //IrParaTela(uAvancaTela.VoltaTela);
    MsgInformativaToolb('Categoria cadastra com exito');  
  end
end;  }
end.
